<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>STUDIOCUT PRO ‚Äî Editor Profesional</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg0: #0a0a0f;
  --bg1: #111118;
  --bg2: #18181f;
  --bg3: #22222d;
  --bg4: #2e2e3a;
  --border: rgba(255,255,255,0.07);
  --border2: rgba(255,255,255,0.12);
  --text1: #f0f0f8;
  --text2: #9090b0;
  --text3: #606080;
  --accent: #7c6aff;
  --accent2: #ff6ac1;
  --accent3: #6affb4;
  --accent4: #ffcc44;
  --red: #ff4466;
  --glow: 0 0 30px rgba(124,106,255,0.25);
  --glow2: 0 0 20px rgba(255,106,193,0.2);
}

*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}

body {
  font-family: 'DM Sans', sans-serif;
  background: var(--bg0);
  color: var(--text1);
  min-height: 100vh;
  overflow-x: hidden;
}

/* Scrollbar */
::-webkit-scrollbar{width:4px;height:4px}
::-webkit-scrollbar-track{background:var(--bg1)}
::-webkit-scrollbar-thumb{background:var(--bg4);border-radius:2px}

/* Animated Background */
.bg-noise {
  position: fixed;
  inset: 0;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E");
  pointer-events: none;
  z-index: 0;
}

.bg-glow {
  position: fixed;
  width: 600px;
  height: 600px;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(124,106,255,0.08) 0%, transparent 70%);
  top: -200px;
  right: -200px;
  pointer-events: none;
  z-index: 0;
}

/* Header */
.header {
  position: sticky;
  top: 0;
  z-index: 100;
  background: rgba(10,10,15,0.85);
  backdrop-filter: blur(20px);
  border-bottom: 1px solid var(--border);
  padding: 0 clamp(16px,3vw,32px);
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.logo {
  font-family: 'Syne', sans-serif;
  font-weight: 800;
  font-size: clamp(1.1em,3vw,1.4em);
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  letter-spacing: -0.5px;
}

.logo span {
  font-weight: 400;
  -webkit-text-fill-color: var(--text2);
}

.header-badge {
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 0.75em;
  font-weight: 600;
  color: white;
  letter-spacing: 0.5px;
}

/* Nav */
.nav {
  display: flex;
  background: var(--bg1);
  border-bottom: 1px solid var(--border);
  overflow-x: auto;
  scrollbar-width: none;
  position: relative;
  z-index: 10;
}
.nav::-webkit-scrollbar{display:none}

.nav-btn {
  flex: 0 0 auto;
  padding: clamp(12px,2.5vw,16px) clamp(14px,3vw,24px);
  background: transparent;
  border: none;
  color: var(--text3);
  font-family: 'DM Sans', sans-serif;
  font-size: clamp(0.8em,2vw,0.95em);
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;
  position: relative;
}

.nav-btn:hover { color: var(--text1); background: var(--bg2); }

.nav-btn.active {
  color: var(--accent);
}

.nav-btn.active::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, var(--accent), var(--accent2));
}

/* Main Content */
.content {
  position: relative;
  z-index: 1;
  padding: clamp(16px,3vw,28px);
  max-width: 1600px;
  margin: 0 auto;
}

.section { display: none; animation: fadeUp 0.3s ease; }
.section.active { display: block; }

@keyframes fadeUp {
  from { opacity: 0; transform: translateY(12px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Hero Section */
.hero {
  text-align: center;
  padding: clamp(30px,6vw,80px) 20px;
}

.hero-tag {
  display: inline-block;
  background: rgba(124,106,255,0.12);
  border: 1px solid rgba(124,106,255,0.3);
  color: var(--accent);
  padding: 6px 16px;
  border-radius: 20px;
  font-size: clamp(0.75em,1.8vw,0.85em);
  font-weight: 600;
  margin-bottom: 20px;
  letter-spacing: 0.5px;
}

.hero h1 {
  font-family: 'Syne', sans-serif;
  font-size: clamp(2em,7vw,5em);
  font-weight: 800;
  line-height: 1.1;
  margin-bottom: 16px;
  background: linear-gradient(135deg, var(--text1) 0%, var(--text2) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.hero h1 .accent {
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.hero p {
  color: var(--text2);
  font-size: clamp(0.95em,2.5vw,1.15em);
  max-width: 600px;
  margin: 0 auto 40px;
  line-height: 1.7;
}

.hero-btns {
  display: flex;
  gap: 12px;
  justify-content: center;
  flex-wrap: wrap;
  margin-bottom: 60px;
}

/* Cards Grid */
.cards-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(min(280px,100%), 1fr));
  gap: clamp(10px,2vw,16px);
  margin: 30px 0;
}

.card {
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: clamp(20px,4vw,28px);
  cursor: pointer;
  transition: all 0.3s;
  position: relative;
  overflow: hidden;
}

.card::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, rgba(124,106,255,0.05) 0%, transparent 100%);
  opacity: 0;
  transition: opacity 0.3s;
}

.card:hover {
  border-color: var(--border2);
  transform: translateY(-4px);
  box-shadow: 0 20px 40px rgba(0,0,0,0.3), var(--glow);
}

.card:hover::before { opacity: 1; }

.card-icon {
  font-size: clamp(2em,5vw,2.5em);
  margin-bottom: 16px;
  display: block;
}

.card h3 {
  font-family: 'Syne', sans-serif;
  font-size: clamp(1.1em,2.5vw,1.3em);
  font-weight: 700;
  margin-bottom: 8px;
}

.card p {
  color: var(--text2);
  font-size: clamp(0.82em,1.8vw,0.92em);
  line-height: 1.6;
}

.card .card-badge {
  position: absolute;
  top: 16px;
  right: 16px;
  background: rgba(124,106,255,0.15);
  border: 1px solid rgba(124,106,255,0.3);
  color: var(--accent);
  padding: 3px 10px;
  border-radius: 10px;
  font-size: 0.7em;
  font-weight: 600;
}

/* Stats */
.stats-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px,1fr));
  gap: clamp(8px,2vw,16px);
  margin: 40px 0;
}

.stat {
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: clamp(16px,3vw,24px);
  text-align: center;
}

.stat-num {
  font-family: 'Syne', sans-serif;
  font-size: clamp(1.5em,4vw,2.5em);
  font-weight: 800;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.stat-label {
  color: var(--text2);
  font-size: clamp(0.75em,1.8vw,0.85em);
  margin-top: 4px;
}

/* Editor Section */
.editor-layout {
  display: grid;
  grid-template-columns: 1fr;
  gap: clamp(12px,2vw,20px);
}

/* Toolbar */
.toolbar {
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 10px 16px;
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  align-items: center;
}

.tool-btn {
  padding: 8px 14px;
  background: var(--bg3);
  border: 1px solid var(--border);
  border-radius: 8px;
  color: var(--text2);
  font-family: 'DM Sans', sans-serif;
  font-size: clamp(0.75em,1.8vw,0.85em);
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;
}

.tool-btn:hover, .tool-btn:active {
  background: var(--bg4);
  color: var(--text1);
  border-color: var(--border2);
}

.tool-divider {
  width: 1px;
  height: 24px;
  background: var(--border);
  flex-shrink: 0;
}

/* Preview */
.preview-wrap {
  background: #000;
  border: 1px solid var(--border);
  border-radius: 16px;
  overflow: hidden;
  position: relative;
  min-height: clamp(260px, 45vw, 480px);
  display: flex;
  align-items: center;
  justify-content: center;
}

.preview-wrap img,
.preview-wrap video {
  max-width: 100%;
  max-height: 480px;
  object-fit: contain;
}

.preview-overlay-text {
  position: absolute;
  pointer-events: none;
  font-family: 'Syne', sans-serif;
  font-size: 2em;
  font-weight: 800;
  text-shadow: 0 2px 8px rgba(0,0,0,0.8);
  white-space: pre-wrap;
  word-break: break-word;
  z-index: 10;
  cursor: move;
  pointer-events: all;
  user-select: none;
}

.drop-zone {
  text-align: center;
  padding: clamp(20px,5vw,40px);
  cursor: pointer;
  width: 100%;
}

.drop-zone .dz-icon {
  font-size: clamp(3em,8vw,5em);
  margin-bottom: 16px;
  opacity: 0.3;
}

.drop-zone p {
  color: var(--text3);
  font-size: clamp(0.9em,2.2vw,1.05em);
  margin-bottom: 20px;
}

.drop-zone.drag-over {
  background: rgba(124,106,255,0.08);
  border: 2px dashed var(--accent);
  border-radius: 12px;
}

/* Timeline */
.timeline-wrap {
  background: var(--bg1);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 16px;
  overflow-x: auto;
}

.timeline-title {
  color: var(--text2);
  font-size: 0.8em;
  font-weight: 600;
  letter-spacing: 1px;
  text-transform: uppercase;
  margin-bottom: 12px;
}

.timeline-track {
  display: flex;
  gap: 6px;
  min-width: min-content;
  padding-bottom: 4px;
}

.t-clip {
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  border-radius: 8px;
  padding: clamp(10px,2vw,14px) clamp(12px,2.5vw,18px);
  min-width: clamp(90px,20vw,130px);
  color: white;
  font-size: clamp(0.75em,1.8vw,0.85em);
  font-weight: 600;
  position: relative;
  cursor: pointer;
  transition: opacity 0.2s;
}

.t-clip:hover { opacity: 0.9; }

.t-clip-remove {
  position: absolute;
  top: -7px;
  right: -7px;
  background: var(--red);
  color: white;
  border: none;
  border-radius: 50%;
  width: 22px;
  height: 22px;
  font-size: 14px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
}

.t-clip-add {
  background: var(--bg3);
  border: 2px dashed var(--border2);
  border-radius: 8px;
  padding: 12px 20px;
  min-width: 90px;
  color: var(--text3);
  font-size: 0.85em;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s;
}

.t-clip-add:hover {
  border-color: var(--accent);
  color: var(--accent);
}

/* Tools Panel */
.tools-panel {
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: 16px;
  overflow: hidden;
}

/* Tab bar */
.tab-bar {
  display: flex;
  background: var(--bg1);
  border-bottom: 1px solid var(--border);
  overflow-x: auto;
  scrollbar-width: none;
}
.tab-bar::-webkit-scrollbar { display: none; }

.tab-btn {
  flex: 0 0 auto;
  padding: clamp(10px,2vw,14px) clamp(12px,2.5vw,20px);
  background: transparent;
  border: none;
  color: var(--text3);
  font-family: 'DM Sans', sans-serif;
  font-size: clamp(0.75em,1.8vw,0.85em);
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;
  position: relative;
}

.tab-btn:hover { color: var(--text1); }

.tab-btn.active {
  color: var(--accent);
  background: var(--bg2);
}

.tab-btn.active::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 8px;
  right: 8px;
  height: 2px;
  background: var(--accent);
  border-radius: 2px;
}

/* Panel Content */
.panel-body {
  padding: clamp(16px,3vw,24px);
  display: none;
}

.panel-body.active { display: block; }

.panel-section {
  margin-bottom: 24px;
}

.panel-label {
  font-size: 0.7em;
  font-weight: 700;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  color: var(--text3);
  margin-bottom: 12px;
}

/* Filter Buttons */
.filter-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(clamp(72px,15vw,88px), 1fr));
  gap: clamp(6px,1.5vw,10px);
}

.filter-chip {
  padding: clamp(8px,2vw,11px) 8px;
  background: var(--bg3);
  border: 1px solid var(--border);
  border-radius: 10px;
  color: var(--text2);
  font-family: 'DM Sans', sans-serif;
  font-size: clamp(0.72em,1.7vw,0.82em);
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  text-align: center;
}

.filter-chip:hover {
  background: var(--bg4);
  color: var(--text1);
  border-color: var(--border2);
  transform: translateY(-1px);
}

.filter-chip.active {
  background: rgba(124,106,255,0.15);
  border-color: var(--accent);
  color: var(--accent);
}

/* Effect Chips */
.effect-chip {
  padding: clamp(10px,2.5vw,14px) 8px;
  background: var(--bg3);
  border: 1px solid var(--border);
  border-radius: 10px;
  color: var(--text2);
  font-family: 'DM Sans', sans-serif;
  font-size: clamp(0.72em,1.7vw,0.82em);
  cursor: pointer;
  transition: all 0.2s;
  text-align: center;
}

.effect-chip:hover {
  background: rgba(255,106,193,0.1);
  border-color: var(--accent2);
  color: var(--accent2);
  transform: translateY(-1px);
}

.effect-chip.active {
  background: rgba(255,106,193,0.15);
  border-color: var(--accent2);
  color: var(--accent2);
}

/* Sliders */
.slider-row {
  margin-bottom: 18px;
}

.slider-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.slider-name {
  font-size: clamp(0.78em,1.8vw,0.88em);
  color: var(--text2);
  font-weight: 500;
}

.slider-val {
  font-size: 0.8em;
  font-weight: 700;
  color: var(--accent);
  font-family: 'Syne', sans-serif;
}

input[type=range] {
  width: 100%;
  height: 4px;
  border-radius: 2px;
  background: var(--bg4);
  outline: none;
  -webkit-appearance: none;
  cursor: pointer;
}

input[type=range]::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: var(--accent);
  box-shadow: 0 0 10px rgba(124,106,255,0.5);
  cursor: pointer;
  transition: transform 0.2s;
}

input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.2); }
input[type=range]::-moz-range-thumb {
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: var(--accent);
  border: none;
  cursor: pointer;
}

/* Speed Grid */
.speed-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(clamp(58px,13vw,75px), 1fr));
  gap: clamp(6px,1.5vw,8px);
}

.speed-chip {
  padding: clamp(8px,2vw,12px) 8px;
  background: var(--bg3);
  border: 1px solid var(--border);
  border-radius: 8px;
  color: var(--text2);
  font-family: 'Syne', sans-serif;
  font-size: clamp(0.72em,1.7vw,0.82em);
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  text-align: center;
}

.speed-chip:hover {
  background: rgba(106,255,180,0.1);
  border-color: var(--accent3);
  color: var(--accent3);
}

.speed-chip.active {
  background: rgba(106,255,180,0.12);
  border-color: var(--accent3);
  color: var(--accent3);
}

/* Aspect Ratio */
.aspect-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(clamp(70px,15vw,90px), 1fr));
  gap: clamp(6px,1.5vw,10px);
}

.aspect-chip {
  padding: clamp(10px,2.5vw,14px) 8px;
  background: var(--bg3);
  border: 1px solid var(--border);
  border-radius: 10px;
  color: var(--text2);
  font-family: 'DM Sans', sans-serif;
  font-size: clamp(0.72em,1.7vw,0.82em);
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  text-align: center;
}

.aspect-chip:hover {
  background: rgba(255,204,68,0.1);
  border-color: var(--accent4);
  color: var(--accent4);
}

.aspect-chip.active {
  background: rgba(255,204,68,0.12);
  border-color: var(--accent4);
  color: var(--accent4);
}

/* Stickers */
.sticker-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(clamp(44px,10vw,56px), 1fr));
  gap: clamp(6px,1.5vw,8px);
}

.sticker-chip {
  aspect-ratio: 1;
  background: var(--bg3);
  border: 1px solid var(--border);
  border-radius: 10px;
  font-size: clamp(1.4em,3.5vw,1.8em);
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.sticker-chip:hover {
  transform: scale(1.15);
  border-color: var(--accent2);
  background: rgba(255,106,193,0.08);
}

/* Transform Grid */
.transform-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(clamp(72px,16vw,90px), 1fr));
  gap: clamp(6px,1.5vw,10px);
}

.transform-chip {
  padding: clamp(10px,2.5vw,13px) 8px;
  background: var(--bg3);
  border: 1px solid var(--border);
  border-radius: 10px;
  color: var(--text2);
  font-size: clamp(0.72em,1.7vw,0.82em);
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  text-align: center;
}

.transform-chip:hover {
  background: var(--bg4);
  color: var(--text1);
  border-color: var(--border2);
}

/* Text Overlay List */
.overlay-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: var(--bg3);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 12px 16px;
  margin-bottom: 8px;
}

.overlay-text { font-size: 0.9em; font-weight: 500; }

.overlay-del {
  background: rgba(255,68,102,0.1);
  border: 1px solid rgba(255,68,102,0.2);
  color: var(--red);
  border-radius: 6px;
  width: 28px;
  height: 28px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1em;
  transition: all 0.2s;
}

.overlay-del:hover { background: rgba(255,68,102,0.2); }

/* Action Buttons */
.action-row {
  display: flex;
  gap: clamp(8px,2vw,12px);
  flex-wrap: wrap;
  margin-top: 20px;
}

/* Buttons */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: clamp(10px,2vw,13px) clamp(18px,4vw,28px);
  border-radius: 10px;
  font-family: 'DM Sans', sans-serif;
  font-size: clamp(0.82em,2vw,0.95em);
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  border: none;
  white-space: nowrap;
}

.btn-primary {
  background: linear-gradient(135deg, var(--accent), #5a48d4);
  color: white;
  box-shadow: 0 4px 20px rgba(124,106,255,0.3);
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(124,106,255,0.4);
}

.btn-ghost {
  background: var(--bg3);
  border: 1px solid var(--border);
  color: var(--text2);
}

.btn-ghost:hover {
  background: var(--bg4);
  border-color: var(--border2);
  color: var(--text1);
}

.btn-success {
  background: linear-gradient(135deg, #2ecc8e, #1aa870);
  color: white;
  box-shadow: 0 4px 20px rgba(46,204,142,0.25);
}

.btn-success:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(46,204,142,0.35);
}

.btn-danger {
  background: rgba(255,68,102,0.12);
  border: 1px solid rgba(255,68,102,0.25);
  color: var(--red);
}

.btn-danger:hover {
  background: rgba(255,68,102,0.2);
}

.btn-sm {
  padding: clamp(7px,1.5vw,9px) clamp(12px,2.5vw,16px);
  font-size: clamp(0.75em,1.8vw,0.85em);
}

/* Color Grid */
.color-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(clamp(36px,8vw,48px), 1fr));
  gap: 8px;
}

.color-swatch {
  aspect-ratio: 1;
  border-radius: 50%;
  cursor: pointer;
  border: 3px solid transparent;
  transition: all 0.2s;
}

.color-swatch:hover { transform: scale(1.1); }
.color-swatch.active { border-color: white; box-shadow: 0 0 0 2px var(--accent); }

/* Modal */
.modal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.8);
  backdrop-filter: blur(8px);
  z-index: 1000;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.modal.active { display: flex; }

.modal-box {
  background: var(--bg2);
  border: 1px solid var(--border2);
  border-radius: 20px;
  padding: clamp(20px,4vw,32px);
  max-width: 520px;
  width: 100%;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 30px 60px rgba(0,0,0,0.5), var(--glow);
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
}

.modal-title {
  font-family: 'Syne', sans-serif;
  font-size: clamp(1.1em,3vw,1.3em);
  font-weight: 700;
}

.modal-close {
  background: var(--bg3);
  border: 1px solid var(--border);
  color: var(--text2);
  border-radius: 8px;
  width: 36px;
  height: 36px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1em;
  transition: all 0.2s;
}

.modal-close:hover { background: var(--bg4); color: var(--text1); }

textarea {
  width: 100%;
  background: var(--bg3);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 14px;
  color: var(--text1);
  font-family: 'DM Sans', sans-serif;
  font-size: clamp(0.9em,2vw,1em);
  resize: vertical;
  min-height: 100px;
  outline: none;
  transition: border-color 0.2s;
}

textarea:focus { border-color: var(--accent); }

input[type=text] {
  width: 100%;
  background: var(--bg3);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 12px 14px;
  color: var(--text1);
  font-family: 'DM Sans', sans-serif;
  font-size: clamp(0.9em,2vw,1em);
  outline: none;
  transition: border-color 0.2s;
}

input[type=text]:focus { border-color: var(--accent); }

/* Quality Options */
.quality-list { display: grid; gap: 10px; }

.quality-item {
  padding: clamp(14px,3vw,18px);
  background: var(--bg3);
  border: 1px solid var(--border);
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 14px;
}

.quality-item:hover { border-color: var(--border2); background: var(--bg4); }
.quality-item.active { border-color: var(--accent); background: rgba(124,106,255,0.08); }

.q-radio {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  border: 2px solid var(--text3);
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: border-color 0.2s;
}

.quality-item.active .q-radio { border-color: var(--accent); }
.quality-item.active .q-radio::after {
  content: '';
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: var(--accent);
}

.q-info h4 {
  font-size: clamp(0.9em,2vw,1em);
  font-weight: 600;
  margin-bottom: 3px;
}

.q-info p {
  font-size: clamp(0.75em,1.8vw,0.82em);
  color: var(--text3);
}

/* Loading */
.loader-overlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.85);
  backdrop-filter: blur(8px);
  z-index: 9999;
  align-items: center;
  justify-content: center;
}

.loader-overlay.active { display: flex; }

.loader-box {
  text-align: center;
  padding: 40px;
}

.loader-ring {
  width: 64px;
  height: 64px;
  border-radius: 50%;
  border: 3px solid var(--bg3);
  border-top-color: var(--accent);
  animation: spin 0.8s linear infinite;
  margin: 0 auto 20px;
}

@keyframes spin { to { transform: rotate(360deg); } }

.loader-title {
  font-family: 'Syne', sans-serif;
  font-size: 1.2em;
  font-weight: 700;
  margin-bottom: 8px;
}

.loader-sub {
  color: var(--text2);
  font-size: 0.9em;
}

/* Progress */
.progress-bar {
  height: 3px;
  background: var(--bg3);
  border-radius: 2px;
  margin-top: 20px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  width: 0%;
  transition: width 0.3s;
  border-radius: 2px;
}

/* Tags */
.tag {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 0.75em;
  font-weight: 600;
}

.tag-purple { background: rgba(124,106,255,0.12); border: 1px solid rgba(124,106,255,0.25); color: var(--accent); }
.tag-pink { background: rgba(255,106,193,0.12); border: 1px solid rgba(255,106,193,0.25); color: var(--accent2); }
.tag-green { background: rgba(106,255,180,0.12); border: 1px solid rgba(106,255,180,0.25); color: var(--accent3); }
.tag-yellow { background: rgba(255,204,68,0.12); border: 1px solid rgba(255,204,68,0.25); color: var(--accent4); }

/* Features list */
.feat-list { display: grid; gap: 10px; }

.feat-item {
  display: flex;
  gap: 14px;
  align-items: flex-start;
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: clamp(12px,2.5vw,16px);
}

.feat-icon {
  font-size: 1.1em;
  flex-shrink: 0;
  margin-top: 1px;
}

.feat-text { font-size: clamp(0.82em,1.8vw,0.92em); color: var(--text2); line-height: 1.5; }
.feat-text strong { color: var(--text1); font-weight: 600; }

/* Hidden inputs */
input[type=file] { display: none; }

/* Quick fab */
.fab {
  position: fixed;
  bottom: clamp(16px,3vw,24px);
  right: clamp(16px,3vw,24px);
  z-index: 999;
  width: clamp(48px,11vw,60px);
  height: clamp(48px,11vw,60px);
  border-radius: 50%;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  box-shadow: 0 8px 24px rgba(124,106,255,0.4);
  border: none;
  color: white;
  font-size: clamp(1.2em,3vw,1.5em);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s;
}

.fab:hover, .fab:active { transform: scale(1.1); box-shadow: 0 12px 32px rgba(124,106,255,0.5); }

/* Separator */
.sep {
  height: 1px;
  background: var(--border);
  margin: 20px 0;
}

/* Responsive */
@media (max-width: 768px) {
  .cards-grid { grid-template-columns: 1fr; }
}

@media (max-width: 480px) {
  .filter-grid { grid-template-columns: repeat(auto-fill, minmax(64px, 1fr)); }
  .sticker-grid { grid-template-columns: repeat(auto-fill, minmax(40px, 1fr)); }
}
</style>
</head>
<body>

<div class="bg-noise"></div>
<div class="bg-glow"></div>

<!-- Header -->
<header class="header">
  <div class="logo">STUDIO<span>CUT</span></div>
  <div style="display:flex; gap:10px; align-items:center;">
    <span class="tag tag-purple">PRO</span>
    <span class="header-badge">100% GRATIS</span>
  </div>
</header>

<!-- Navigation -->
<nav class="nav">
  <button class="nav-btn active" onclick="switchTab('home')">üè† Inicio</button>
  <button class="nav-btn" onclick="switchTab('video')">üé¨ Video</button>
  <button class="nav-btn" onclick="switchTab('photo')">üì∏ Foto</button>
  <button class="nav-btn" onclick="switchTab('collage')">üñºÔ∏è Collage</button>
  <button class="nav-btn" onclick="switchTab('gif')">üéûÔ∏è GIF</button>
  <button class="nav-btn" onclick="switchTab('tools')">üõ†Ô∏è Tools</button>
</nav>

<!-- Content -->
<div class="content">

  <!-- HOME -->
  <div id="home" class="section active">
    <div class="hero">
      <div class="hero-tag">‚ú¶ EDITOR PROFESIONAL ‚Äî VERSI√ìN ULTRA</div>
      <h1>Edita como un<br><span class="accent">Profesional</span></h1>
      <p>La herramienta de edici√≥n m√°s completa, totalmente gratis. Sin marcas de agua, sin l√≠mites, sin suscripciones.</p>
      <div class="hero-btns">
        <button class="btn btn-primary" onclick="switchTab('video'); document.querySelectorAll('.nav-btn')[1].classList.add('active'); document.querySelectorAll('.nav-btn')[0].classList.remove('active');">üé¨ Editar Video</button>
        <button class="btn btn-ghost" onclick="switchTab('photo'); document.querySelectorAll('.nav-btn')[2].classList.add('active'); document.querySelectorAll('.nav-btn')[0].classList.remove('active');">üì∏ Editar Foto</button>
      </div>
    </div>

    <div class="stats-row">
      <div class="stat">
        <div class="stat-num">20+</div>
        <div class="stat-label">Filtros Premium</div>
      </div>
      <div class="stat">
        <div class="stat-num">10</div>
        <div class="stat-label">Efectos Especiales</div>
      </div>
      <div class="stat">
        <div class="stat-num">8K</div>
        <div class="stat-label">Resoluci√≥n M√°x</div>
      </div>
      <div class="stat">
        <div class="stat-num">‚àû</div>
        <div class="stat-label">Sin L√≠mites</div>
      </div>
      <div class="stat">
        <div class="stat-num">$0</div>
        <div class="stat-label">Para Siempre</div>
      </div>
    </div>

    <div class="cards-grid">
      <div class="card" onclick="switchTab('video'); document.querySelectorAll('.nav-btn')[1].classList.add('active'); document.querySelectorAll('.nav-btn')[0].classList.remove('active');">
        <span class="card-badge">NUEVO</span>
        <span class="card-icon">üé¨</span>
        <h3>Editor de Video</h3>
        <p>Timeline multipista, 20+ filtros, efectos especiales, control de velocidad, audio y mucho m√°s.</p>
      </div>
      <div class="card" onclick="switchTab('photo'); document.querySelectorAll('.nav-btn')[2].classList.add('active'); document.querySelectorAll('.nav-btn')[0].classList.remove('active');">
        <span class="card-icon">üì∏</span>
        <h3>Editor de Fotos</h3>
        <p>Filtros profesionales, ajustes avanzados, marcos, stickers, texto y exportaci√≥n en 4K.</p>
      </div>
      <div class="card" onclick="switchTab('collage'); document.querySelectorAll('.nav-btn')[3].classList.add('active'); document.querySelectorAll('.nav-btn')[0].classList.remove('active');">
        <span class="card-icon">üñºÔ∏è</span>
        <h3>Collage</h3>
        <p>Combina hasta 9 fotos en layouts creativos. Perfecto para Instagram y redes sociales.</p>
      </div>
      <div class="card" onclick="switchTab('gif'); document.querySelectorAll('.nav-btn')[4].classList.add('active'); document.querySelectorAll('.nav-btn')[0].classList.remove('active');">
        <span class="card-icon">üéûÔ∏è</span>
        <h3>GIF Maker</h3>
        <p>Convierte cualquier video en GIF animado optimizado.</p>
      </div>
      <div class="card" onclick="switchTab('tools'); document.querySelectorAll('.nav-btn')[5].classList.add('active'); document.querySelectorAll('.nav-btn')[0].classList.remove('active');">
        <span class="card-icon">üõ†Ô∏è</span>
        <h3>Herramientas</h3>
        <p>Conversor, compresor, extractor de audio y m√°s utilidades profesionales.</p>
      </div>
    </div>

    <div class="sep"></div>

    <h2 style="font-family:'Syne',sans-serif; font-size:clamp(1.3em,4vw,1.8em); font-weight:700; margin-bottom:20px;">
      ‚ú¶ Todo lo que incluye
    </h2>
    <div class="feat-list">
      <div class="feat-item"><span class="feat-icon">üé®</span><div class="feat-text"><strong>20+ Filtros Profesionales:</strong> Vintage, Cinematic, Nashville, Lomo, Fade, Neon, Retro, Drama y m√°s</div></div>
      <div class="feat-item"><span class="feat-icon">‚ö°</span><div class="feat-text"><strong>Control de Velocidad:</strong> Desde 0.1x hasta 10x ‚Äî slow motion extremo y time-lapse profesional</div></div>
      <div class="feat-item"><span class="feat-icon">‚ú®</span><div class="feat-text"><strong>10 Efectos Especiales:</strong> Blur, Glow, Vignette, Pixelate, Sharpen, Invert, Glitch, Chromatic</div></div>
      <div class="feat-item"><span class="feat-icon">üîä</span><div class="feat-text"><strong>Audio Profesional:</strong> Control de volumen, mezcla, m√∫sica de fondo, fade in/out, silenciar</div></div>
      <div class="feat-item"><span class="feat-icon">üìê</span><div class="feat-text"><strong>6 Formatos de Aspecto:</strong> 16:9 YouTube, 9:16 TikTok, 1:1 Instagram, 4:3 Cl√°sico, 21:9 Cinema, 4:5 Facebook</div></div>
      <div class="feat-item"><span class="feat-icon">üîÑ</span><div class="feat-text"><strong>Rotaci√≥n y Volteo:</strong> Rotar -90¬∞, 90¬∞, 180¬∞ + voltear horizontal y vertical</div></div>
      <div class="feat-item"><span class="feat-icon">‚úèÔ∏è</span><div class="feat-text"><strong>Textos Personalizados:</strong> M√∫ltiples capas, 8 colores, 3 estilos (Normal, Bold, Italic), tama√±o ajustable</div></div>
      <div class="feat-item"><span class="feat-icon">üòÄ</span><div class="feat-text"><strong>50+ Stickers:</strong> Emojis y decoraciones para agregar a videos y fotos</div></div>
      <div class="feat-item"><span class="feat-icon">üíæ</span><div class="feat-text"><strong>Exportaci√≥n hasta 8K:</strong> 720p, 1080p, 4K, 8K ‚Äî sin marca de agua, calidad m√°xima</div></div>
      <div class="feat-item"><span class="feat-icon">üîí</span><div class="feat-text"><strong>100% Privado:</strong> Tus archivos nunca salen de tu dispositivo, procesamiento local total</div></div>
      <div class="feat-item"><span class="feat-icon">üì±</span><div class="feat-text"><strong>100% Responsive:</strong> Optimizado para m√≥viles, tablets y escritorio</div></div>
      <div class="feat-item"><span class="feat-icon">üåê</span><div class="feat-text"><strong>Funciona Offline:</strong> No requiere internet, instala como app en tu dispositivo</div></div>
    </div>
  </div>

  <!-- VIDEO EDITOR -->
  <div id="video" class="section">
    <div class="editor-layout">
      <!-- Toolbar -->
      <div class="toolbar">
        <button class="tool-btn" onclick="resetVideo()">‚Ü∫ Reset</button>
        <div class="tool-divider"></div>
        <button class="tool-btn" onclick="muteVideo()">üîá Silenciar</button>
        <button class="tool-btn" onclick="document.getElementById('audioInput').click()">üéµ M√∫sica</button>
        <div class="tool-divider"></div>
        <button class="tool-btn" onclick="openTextModal()">‚úèÔ∏è Texto</button>
        <div class="tool-divider"></div>
        <span style="color:var(--text3); font-size:0.8em; margin-left:auto; white-space:nowrap">
          üé¨ <span id="clipCount">0</span> clips
        </span>
      </div>

      <!-- Preview -->
      <div class="preview-wrap" id="videoPreview">
        <div class="drop-zone" id="videoDrop" onclick="document.getElementById('videoInput').click()"
          ondragover="handleDragOver(event)" ondrop="handleDrop(event,'video')" ondragleave="handleDragLeave(event)">
          <div class="dz-icon">üé¨</div>
          <p>Arrastra tu video aqu√≠ o toca para seleccionar</p>
          <button class="btn btn-primary" onclick="event.stopPropagation(); document.getElementById('videoInput').click()">
            Ôºã Seleccionar Video
          </button>
        </div>
      </div>

      <!-- Timeline -->
      <div class="timeline-wrap" id="videoTimeline" style="display:none">
        <div class="timeline-title">L√çNEA DE TIEMPO ‚Äî PISTAS</div>
        <div class="timeline-track" id="clipTrack">
          <div class="t-clip-add" onclick="document.getElementById('videoInput').click()">Ôºã Clip</div>
        </div>
      </div>

      <!-- Tools Panel -->
      <div class="tools-panel" id="videoTools" style="display:none">
        <div class="tab-bar">
          <button class="tab-btn active" onclick="showVideoTab('filters')">üé® Filtros</button>
          <button class="tab-btn" onclick="showVideoTab('effects')">‚ú® Efectos</button>
          <button class="tab-btn" onclick="showVideoTab('adjust')">‚öôÔ∏è Ajustes</button>
          <button class="tab-btn" onclick="showVideoTab('text')">‚úèÔ∏è Texto</button>
          <button class="tab-btn" onclick="showVideoTab('audio')">üîä Audio</button>
          <button class="tab-btn" onclick="showVideoTab('transform')">üîÑ Transform</button>
          <button class="tab-btn" onclick="showVideoTab('stickers')">üòÄ Stickers</button>
          <button class="tab-btn" onclick="showVideoTab('export')">üíæ Exportar</button>
        </div>

        <!-- Filters -->
        <div id="vFilters" class="panel-body active">
          <div class="panel-section">
            <div class="panel-label">Filtros Cinematogr√°ficos</div>
            <div class="filter-grid">
              <button class="filter-chip active" onclick="setVideoFilter('none',this)">Original</button>
              <button class="filter-chip" onclick="setVideoFilter('vintage',this)">Vintage</button>
              <button class="filter-chip" onclick="setVideoFilter('bw',this)">B&N</button>
              <button class="filter-chip" onclick="setVideoFilter('sepia',this)">Sepia</button>
              <button class="filter-chip" onclick="setVideoFilter('cool',this)">Fr√≠o</button>
              <button class="filter-chip" onclick="setVideoFilter('warm',this)">C√°lido</button>
              <button class="filter-chip" onclick="setVideoFilter('vibrant',this)">Vibrante</button>
              <button class="filter-chip" onclick="setVideoFilter('dramatic',this)">Dram√°tico</button>
              <button class="filter-chip" onclick="setVideoFilter('cinematic',this)">Cinema</button>
              <button class="filter-chip" onclick="setVideoFilter('retro',this)">Retro</button>
              <button class="filter-chip" onclick="setVideoFilter('nashville',this)">Nashville</button>
              <button class="filter-chip" onclick="setVideoFilter('lomo',this)">Lomo</button>
              <button class="filter-chip" onclick="setVideoFilter('fade',this)">Fade</button>
              <button class="filter-chip" onclick="setVideoFilter('neon',this)">Neon</button>
              <button class="filter-chip" onclick="setVideoFilter('haze',this)">Haze</button>
              <button class="filter-chip" onclick="setVideoFilter('muted',this)">Muted</button>
            </div>
          </div>
        </div>

        <!-- Effects -->
        <div id="vEffects" class="panel-body">
          <div class="panel-section">
            <div class="panel-label">Efectos Especiales</div>
            <div class="filter-grid">
              <button class="effect-chip" onclick="setVideoEffect('blur',this)"><div>üí´</div>Blur</button>
              <button class="effect-chip" onclick="setVideoEffect('sharpen',this)"><div>üîç</div>Sharpen</button>
              <button class="effect-chip" onclick="setVideoEffect('vignette',this)"><div>üåë</div>Vignette</button>
              <button class="effect-chip" onclick="setVideoEffect('glow',this)"><div>‚ú®</div>Glow</button>
              <button class="effect-chip" onclick="setVideoEffect('pixelate',this)"><div>‚¨ú</div>Pixel</button>
              <button class="effect-chip" onclick="setVideoEffect('invert',this)"><div>üîÑ</div>Invert</button>
              <button class="effect-chip" onclick="setVideoEffect('glitch',this)"><div>üì∫</div>Glitch</button>
              <button class="effect-chip" onclick="setVideoEffect('chromatic',this)"><div>üåà</div>Chromatic</button>
            </div>
          </div>
        </div>

        <!-- Adjust -->
        <div id="vAdjust" class="panel-body">
          <div class="panel-section">
            <div class="panel-label">Velocidad</div>
            <div class="speed-grid">
              <button class="speed-chip" onclick="setSpeed(0.1)">0.1x</button>
              <button class="speed-chip" onclick="setSpeed(0.25)">0.25x</button>
              <button class="speed-chip" onclick="setSpeed(0.5)">0.5x</button>
              <button class="speed-chip active" onclick="setSpeed(1)">1x</button>
              <button class="speed-chip" onclick="setSpeed(1.5)">1.5x</button>
              <button class="speed-chip" onclick="setSpeed(2)">2x</button>
              <button class="speed-chip" onclick="setSpeed(3)">3x</button>
              <button class="speed-chip" onclick="setSpeed(5)">5x</button>
            </div>
          </div>
          <div class="sep"></div>
          <div class="panel-section">
            <div class="panel-label">Formato de Aspecto</div>
            <div class="aspect-grid">
              <button class="aspect-chip active" onclick="setAspect('16:9',this)">16:9<br><small style="opacity:.6">YouTube</small></button>
              <button class="aspect-chip" onclick="setAspect('9:16',this)">9:16<br><small style="opacity:.6">TikTok</small></button>
              <button class="aspect-chip" onclick="setAspect('1:1',this)">1:1<br><small style="opacity:.6">IG Post</small></button>
              <button class="aspect-chip" onclick="setAspect('4:3',this)">4:3<br><small style="opacity:.6">Cl√°sico</small></button>
              <button class="aspect-chip" onclick="setAspect('21:9',this)">21:9<br><small style="opacity:.6">Cinema</small></button>
              <button class="aspect-chip" onclick="setAspect('4:5',this)">4:5<br><small style="opacity:.6">Facebook</small></button>
            </div>
          </div>
          <div class="sep"></div>
          <div class="panel-section">
            <div class="slider-row">
              <div class="slider-header"><span class="slider-name">üîä Volumen</span><span class="slider-val" id="volVal">100%</span></div>
              <input type="range" min="0" max="200" value="100" oninput="setVolume(this)">
            </div>
          </div>
        </div>

        <!-- Text -->
        <div id="vText" class="panel-body">
          <div class="panel-section">
            <button class="btn btn-primary" style="width:100%; margin-bottom:16px;" onclick="openTextModal()">Ôºã Agregar Texto</button>
            <div id="textList"></div>
          </div>
        </div>

        <!-- Audio -->
        <div id="vAudio" class="panel-body">
          <div class="panel-section">
            <div class="panel-label">Controles de Audio</div>
            <div style="display:flex; gap:10px; flex-wrap:wrap; margin-bottom:20px;">
              <label for="audioInput" class="btn btn-ghost btn-sm">üéµ Agregar M√∫sica</label>
              <button class="btn btn-ghost btn-sm" onclick="muteVideo()" id="muteBtn">üîá Silenciar</button>
              <button class="btn btn-ghost btn-sm" onclick="alert('üéº Extrae el audio seleccionando el archivo y usando la herramienta de audio.')">üéº Extraer Audio</button>
            </div>
            <div class="slider-row">
              <div class="slider-header"><span class="slider-name">üéµ Volumen M√∫sica</span><span class="slider-val" id="musicVolVal">100%</span></div>
              <input type="range" min="0" max="200" value="100" oninput="document.getElementById('musicVolVal').textContent=this.value+'%'">
            </div>
          </div>
        </div>

        <!-- Transform -->
        <div id="vTransform" class="panel-body">
          <div class="panel-section">
            <div class="panel-label">Rotaci√≥n</div>
            <div class="transform-grid">
              <button class="transform-chip" onclick="rotateVideo(-90)">‚Ü∂ ‚àí90¬∞</button>
              <button class="transform-chip" onclick="rotateVideo(90)">‚Ü∑ +90¬∞</button>
              <button class="transform-chip" onclick="rotateVideo(180)">‚Üª 180¬∞</button>
              <button class="transform-chip" onclick="rotateVideo(0,'reset')">‚äô Reset</button>
            </div>
          </div>
          <div class="sep"></div>
          <div class="panel-section">
            <div class="panel-label">Voltear</div>
            <div class="transform-grid">
              <button class="transform-chip" onclick="flipVideo('h')">‚Üî Horizontal</button>
              <button class="transform-chip" onclick="flipVideo('v')">‚Üï Vertical</button>
            </div>
          </div>
        </div>

        <!-- Stickers -->
        <div id="vStickers" class="panel-body">
          <div class="panel-section">
            <div class="panel-label">Emojis & Stickers</div>
            <div class="sticker-grid">
              <button class="sticker-chip" onclick="addSticker('‚ù§Ô∏è')">‚ù§Ô∏è</button>
              <button class="sticker-chip" onclick="addSticker('üî•')">üî•</button>
              <button class="sticker-chip" onclick="addSticker('‚≠ê')">‚≠ê</button>
              <button class="sticker-chip" onclick="addSticker('üíØ')">üíØ</button>
              <button class="sticker-chip" onclick="addSticker('üëç')">üëç</button>
              <button class="sticker-chip" onclick="addSticker('üéâ')">üéâ</button>
              <button class="sticker-chip" onclick="addSticker('‚ú®')">‚ú®</button>
              <button class="sticker-chip" onclick="addSticker('üòç')">üòç</button>
              <button class="sticker-chip" onclick="addSticker('üåü')">üåü</button>
              <button class="sticker-chip" onclick="addSticker('üí´')">üí´</button>
              <button class="sticker-chip" onclick="addSticker('üéà')">üéà</button>
              <button class="sticker-chip" onclick="addSticker('üéä')">üéä</button>
              <button class="sticker-chip" onclick="addSticker('üåà')">üåà</button>
              <button class="sticker-chip" onclick="addSticker('ü¶ã')">ü¶ã</button>
              <button class="sticker-chip" onclick="addSticker('üéµ')">üéµ</button>
              <button class="sticker-chip" onclick="addSticker('üèÜ')">üèÜ</button>
            </div>
          </div>
        </div>

        <!-- Export -->
        <div id="vExport" class="panel-body">
          <div class="panel-section">
            <div class="panel-label">Calidad de Exportaci√≥n</div>
            <div class="quality-list">
              <div class="quality-item" onclick="setQuality('720p',this)">
                <div class="q-radio"></div>
                <div class="q-info"><h4>720p HD</h4><p>1280√ó720 ‚Äî Archivos peque√±os</p></div>
                <span class="tag tag-green" style="margin-left:auto">R√°pido</span>
              </div>
              <div class="quality-item active" onclick="setQuality('1080p',this)">
                <div class="q-radio"></div>
                <div class="q-info"><h4>1080p Full HD</h4><p>1920√ó1080 ‚Äî Recomendado</p></div>
                <span class="tag tag-purple" style="margin-left:auto">Popular</span>
              </div>
              <div class="quality-item" onclick="setQuality('4k',this)">
                <div class="q-radio"></div>
                <div class="q-info"><h4>4K Ultra HD</h4><p>3840√ó2160 ‚Äî Alta calidad</p></div>
                <span class="tag tag-yellow" style="margin-left:auto">Pro</span>
              </div>
            </div>
            <div class="sep"></div>
            <button class="btn btn-success" style="width:100%;" onclick="doExportVideo()">
              üöÄ Exportar Video Sin Marca de Agua
            </button>
          </div>
        </div>
      </div>

      <!-- Actions -->
      <div class="action-row">
        <label for="videoInput" class="btn btn-ghost">üîÑ Cambiar</label>
        <button class="btn btn-success" id="exportVideoFab" style="display:none" onclick="showVideoTab('export'); document.querySelectorAll('#video .tab-btn')[7].classList.add('active')">üíæ Exportar</button>
      </div>
    </div>
  </div>

  <!-- PHOTO EDITOR -->
  <div id="photo" class="section">
    <div class="editor-layout">
      <div class="toolbar">
        <button class="tool-btn" onclick="resetPhoto()">‚Ü∫ Reset</button>
        <div class="tool-divider"></div>
        <button class="tool-btn" onclick="comparePhoto()" id="compareBtn">üëÅ Comparar</button>
        <div class="tool-divider"></div>
        <button class="tool-btn" onclick="openTextModal()">‚úèÔ∏è Texto</button>
      </div>

      <div class="preview-wrap" id="photoPreview">
        <div class="drop-zone" id="photoDrop" onclick="document.getElementById('photoInput').click()"
          ondragover="handleDragOver(event)" ondrop="handleDrop(event,'photo')" ondragleave="handleDragLeave(event)">
          <div class="dz-icon">üì∏</div>
          <p>Arrastra tu foto aqu√≠ o toca para seleccionar</p>
          <button class="btn btn-primary" onclick="event.stopPropagation(); document.getElementById('photoInput').click()">
            Ôºã Seleccionar Foto
          </button>
        </div>
      </div>

      <div class="tools-panel" id="photoTools" style="display:none">
        <div class="tab-bar">
          <button class="tab-btn active" onclick="showPhotoTab('filters')">üé® Filtros</button>
          <button class="tab-btn" onclick="showPhotoTab('adjust')">‚öôÔ∏è Ajustes</button>
          <button class="tab-btn" onclick="showPhotoTab('effects')">‚ú® Efectos</button>
          <button class="tab-btn" onclick="showPhotoTab('transform')">üîÑ Transform</button>
          <button class="tab-btn" onclick="showPhotoTab('stickers')">üòÄ Stickers</button>
          <button class="tab-btn" onclick="showPhotoTab('export')">üíæ Exportar</button>
        </div>

        <!-- Filters -->
        <div id="pFilters" class="panel-body active">
          <div class="panel-section">
            <div class="panel-label">Filtros</div>
            <div class="filter-grid">
              <button class="filter-chip active" onclick="setPhotoFilter('none',this)">Original</button>
              <button class="filter-chip" onclick="setPhotoFilter('vintage',this)">Vintage</button>
              <button class="filter-chip" onclick="setPhotoFilter('bw',this)">B&N</button>
              <button class="filter-chip" onclick="setPhotoFilter('sepia',this)">Sepia</button>
              <button class="filter-chip" onclick="setPhotoFilter('cool',this)">Fr√≠o</button>
              <button class="filter-chip" onclick="setPhotoFilter('warm',this)">C√°lido</button>
              <button class="filter-chip" onclick="setPhotoFilter('vibrant',this)">Vibrante</button>
              <button class="filter-chip" onclick="setPhotoFilter('fade',this)">Fade</button>
              <button class="filter-chip" onclick="setPhotoFilter('nashville',this)">Nashville</button>
              <button class="filter-chip" onclick="setPhotoFilter('lomo',this)">Lomo</button>
              <button class="filter-chip" onclick="setPhotoFilter('dramatic',this)">Dramatic</button>
              <button class="filter-chip" onclick="setPhotoFilter('neon',this)">Neon</button>
            </div>
          </div>
        </div>

        <!-- Adjust -->
        <div id="pAdjust" class="panel-body">
          <div class="panel-section">
            <div class="slider-row">
              <div class="slider-header"><span class="slider-name">‚òÄÔ∏è Brillo</span><span class="slider-val" id="pBrightVal">100%</span></div>
              <input type="range" min="50" max="150" value="100" oninput="adjustPhoto('brightness',this)">
            </div>
            <div class="slider-row">
              <div class="slider-header"><span class="slider-name">üîÜ Contraste</span><span class="slider-val" id="pContrastVal">100%</span></div>
              <input type="range" min="50" max="150" value="100" oninput="adjustPhoto('contrast',this)">
            </div>
            <div class="slider-row">
              <div class="slider-header"><span class="slider-name">üé® Saturaci√≥n</span><span class="slider-val" id="pSatVal">100%</span></div>
              <input type="range" min="0" max="200" value="100" oninput="adjustPhoto('saturate',this)">
            </div>
            <div class="slider-row">
              <div class="slider-header"><span class="slider-name">üåà Tono</span><span class="slider-val" id="pHueVal">0¬∞</span></div>
              <input type="range" min="0" max="360" value="0" oninput="adjustPhoto('hue',this)">
            </div>
            <div class="slider-row">
              <div class="slider-header"><span class="slider-name">üí´ Blur</span><span class="slider-val" id="pBlurVal">0px</span></div>
              <input type="range" min="0" max="20" value="0" oninput="adjustPhoto('blur',this)">
            </div>
          </div>
        </div>

        <!-- Effects -->
        <div id="pEffects" class="panel-body">
          <div class="panel-section">
            <div class="panel-label">Efectos Visuales</div>
            <div class="filter-grid">
              <button class="effect-chip" onclick="togglePhotoEffect('vignette',this)"><div>üåë</div>Vignette</button>
              <button class="effect-chip" onclick="togglePhotoEffect('sharpen',this)"><div>üîç</div>Sharpen</button>
              <button class="effect-chip" onclick="togglePhotoEffect('glow',this)"><div>‚ú®</div>Glow</button>
              <button class="effect-chip" onclick="togglePhotoEffect('invert',this)"><div>üîÑ</div>Invert</button>
            </div>
          </div>
        </div>

        <!-- Transform -->
        <div id="pTransform" class="panel-body">
          <div class="panel-section">
            <div class="panel-label">Rotaci√≥n</div>
            <div class="transform-grid">
              <button class="transform-chip" onclick="rotatePhoto(-90)">‚Ü∂ ‚àí90¬∞</button>
              <button class="transform-chip" onclick="rotatePhoto(90)">‚Ü∑ +90¬∞</button>
              <button class="transform-chip" onclick="rotatePhoto(180)">‚Üª 180¬∞</button>
              <button class="transform-chip" onclick="rotatePhoto(0,'reset')">‚äô Reset</button>
            </div>
          </div>
          <div class="sep"></div>
          <div class="panel-section">
            <div class="panel-label">Voltear</div>
            <div class="transform-grid">
              <button class="transform-chip" onclick="flipPhoto('h')">‚Üî Horizontal</button>
              <button class="transform-chip" onclick="flipPhoto('v')">‚Üï Vertical</button>
            </div>
          </div>
        </div>

        <!-- Stickers -->
        <div id="pStickers" class="panel-body">
          <div class="panel-section">
            <div class="panel-label">Emojis & Stickers</div>
            <div class="sticker-grid">
              <button class="sticker-chip" onclick="notifySticker('‚ù§Ô∏è')">‚ù§Ô∏è</button>
              <button class="sticker-chip" onclick="notifySticker('üî•')">üî•</button>
              <button class="sticker-chip" onclick="notifySticker('‚≠ê')">‚≠ê</button>
              <button class="sticker-chip" onclick="notifySticker('üíØ')">üíØ</button>
              <button class="sticker-chip" onclick="notifySticker('‚ú®')">‚ú®</button>
              <button class="sticker-chip" onclick="notifySticker('üéâ')">üéâ</button>
              <button class="sticker-chip" onclick="notifySticker('üòç')">üòç</button>
              <button class="sticker-chip" onclick="notifySticker('üåü')">üåü</button>
              <button class="sticker-chip" onclick="notifySticker('ü¶ã')">ü¶ã</button>
              <button class="sticker-chip" onclick="notifySticker('üåà')">üåà</button>
              <button class="sticker-chip" onclick="notifySticker('üéµ')">üéµ</button>
              <button class="sticker-chip" onclick="notifySticker('üèÜ')">üèÜ</button>
            </div>
          </div>
        </div>

        <!-- Export -->
        <div id="pExport" class="panel-body">
          <div class="panel-section">
            <div class="panel-label">Calidad de Exportaci√≥n</div>
            <div class="quality-list">
              <div class="quality-item" onclick="setQuality('720p',this)">
                <div class="q-radio"></div>
                <div class="q-info"><h4>720p</h4><p>1280√ó720</p></div>
              </div>
              <div class="quality-item active" onclick="setQuality('1080p',this)">
                <div class="q-radio"></div>
                <div class="q-info"><h4>1080p Full HD</h4><p>1920√ó1080</p></div>
              </div>
              <div class="quality-item" onclick="setQuality('4k',this)">
                <div class="q-radio"></div>
                <div class="q-info"><h4>4K</h4><p>3840√ó2160</p></div>
              </div>
            </div>
            <div class="sep"></div>
            <button class="btn btn-success" style="width:100%;" onclick="doExportPhoto()">
              üíæ Guardar Foto Sin Marca de Agua
            </button>
          </div>
        </div>
      </div>

      <div class="action-row">
        <label for="photoInput" class="btn btn-ghost">üîÑ Cambiar</label>
        <button class="btn btn-success" id="exportPhotoFab" style="display:none" onclick="showPhotoTab('export'); document.querySelectorAll('#photo .tab-btn')[5].classList.add('active')">üíæ Guardar</button>
      </div>
    </div>
  </div>

  <!-- COLLAGE -->
  <div id="collage" class="section">
    <div style="text-align:center; padding:clamp(30px,6vw,60px) 20px;">
      <div style="font-size:clamp(2.5em,8vw,4em); margin-bottom:20px;">üñºÔ∏è</div>
      <h2 style="font-family:'Syne',sans-serif; font-size:clamp(1.5em,4vw,2.2em); font-weight:800; margin-bottom:12px;">Creador de Collage</h2>
      <p style="color:var(--text2); margin-bottom:40px;">Combina m√∫ltiples fotos en un solo dise√±o</p>
      <div class="cards-grid" style="max-width:700px; margin:0 auto 40px;">
        <div class="card" onclick="document.getElementById('collageInput').click()">
          <span class="card-icon">‚¨õ‚¨ú</span>
          <h3>2 Fotos</h3>
          <p>Dise√±o lado a lado</p>
        </div>
        <div class="card" onclick="document.getElementById('collageInput').click()">
          <span class="card-icon">‚ñ™Ô∏è‚ñ™Ô∏è</span>
          <h3>4 Fotos</h3>
          <p>Grid cuadrado</p>
        </div>
        <div class="card" onclick="document.getElementById('collageInput').click()">
          <span class="card-icon">‚ñ™Ô∏è‚ñ™Ô∏è‚ñ™Ô∏è</span>
          <h3>9 Fotos</h3>
          <p>Grid Instagram</p>
        </div>
      </div>
      <label for="collageInput" class="btn btn-primary">Ôºã Seleccionar Fotos</label>
    </div>
  </div>

  <!-- GIF -->
  <div id="gif" class="section">
    <div style="text-align:center; padding:clamp(30px,6vw,60px) 20px;">
      <div style="font-size:clamp(2.5em,8vw,4em); margin-bottom:20px;">üéûÔ∏è</div>
      <h2 style="font-family:'Syne',sans-serif; font-size:clamp(1.5em,4vw,2.2em); font-weight:800; margin-bottom:12px;">GIF Maker</h2>
      <p style="color:var(--text2); margin-bottom:40px;">Convierte tus videos en GIFs animados optimizados</p>
      <div class="stats-row" style="max-width:500px; margin:0 auto 40px;">
        <div class="stat"><div class="stat-num">‚ö°</div><div class="stat-label">Instant√°neo</div></div>
        <div class="stat"><div class="stat-num">üé®</div><div class="stat-label">Personalizable</div></div>
        <div class="stat"><div class="stat-num">üíæ</div><div class="stat-label">Optimizado</div></div>
      </div>
      <label for="gifInput" class="btn btn-primary">üé• Seleccionar Video</label>
    </div>
  </div>

  <!-- TOOLS -->
  <div id="tools" class="section">
    <h2 style="font-family:'Syne',sans-serif; font-size:clamp(1.3em,4vw,1.8em); font-weight:800; margin-bottom:24px;">üõ†Ô∏è Herramientas</h2>
    <div class="cards-grid">
      <div class="card" onclick="toolAlert('Conversor de Formato')">
        <span class="card-icon">üîÑ</span>
        <h3>Conversor</h3>
        <p>Convierte entre MP4, MOV, AVI, WebM</p>
      </div>
      <div class="card" onclick="toolAlert('Compresor de Video')">
        <span class="card-icon">üì¶</span>
        <h3>Compresor</h3>
        <p>Reduce tama√±o sin perder calidad</p>
      </div>
      <div class="card" onclick="toolAlert('Unidor de Videos')">
        <span class="card-icon">‚ûï</span>
        <h3>Unir Videos</h3>
        <p>Combina m√∫ltiples clips</p>
      </div>
      <div class="card" onclick="toolAlert('Recortador de Video')">
        <span class="card-icon">‚úÇÔ∏è</span>
        <h3>Recortar</h3>
        <p>Selecciona el segmento exacto</p>
      </div>
      <div class="card" onclick="toolAlert('Extractor de Audio')">
        <span class="card-icon">üéµ</span>
        <h3>Extraer Audio</h3>
        <p>Obt√©n MP3 de tus videos</p>
      </div>
      <div class="card" onclick="toolAlert('Marca de Agua')">
        <span class="card-icon">¬©Ô∏è</span>
        <h3>Marca de Agua</h3>
        <p>Agrega tu logo o texto</p>
      </div>
    </div>
  </div>

</div><!-- /content -->

<!-- FAB -->
<button class="fab" onclick="window.scrollTo({top:0,behavior:'smooth'})">‚¨Ü</button>

<!-- Hidden Inputs -->
<input type="file" id="videoInput" accept="video/*" multiple onchange="loadVideo(event)">
<input type="file" id="photoInput" accept="image/*" onchange="loadPhoto(event)">
<input type="file" id="audioInput" accept="audio/*" onchange="loadAudio(event)">
<input type="file" id="collageInput" accept="image/*" multiple onchange="loadCollage(event)">
<input type="file" id="gifInput" accept="video/*" onchange="alert('üéûÔ∏è Video cargado. GIF Maker en desarrollo.')">

<!-- Text Modal -->
<div id="textModal" class="modal">
  <div class="modal-box">
    <div class="modal-header">
      <div class="modal-title">‚úèÔ∏è Agregar Texto</div>
      <button class="modal-close" onclick="document.getElementById('textModal').classList.remove('active')">‚úï</button>
    </div>

    <div class="panel-label" style="margin-bottom:10px;">Texto</div>
    <textarea id="textInput" placeholder="Escribe tu texto aqu√≠..."></textarea>

    <div class="sep"></div>

    <div class="panel-label">Tama√±o</div>
    <div class="slider-row">
      <div class="slider-header"><span class="slider-name">Fuente</span><span class="slider-val" id="fontSzVal">32px</span></div>
      <input type="range" min="12" max="80" value="32" oninput="document.getElementById('fontSzVal').textContent=this.value+'px'; selFontSize=this.value">
    </div>

    <div class="sep"></div>

    <div class="panel-label">Color</div>
    <div class="color-grid" style="margin-bottom:20px;">
      <div class="color-swatch active" style="background:#fff;" data-color="#fff"></div>
      <div class="color-swatch" style="background:#000;" data-color="#000"></div>
      <div class="color-swatch" style="background:#7c6aff;" data-color="#7c6aff"></div>
      <div class="color-swatch" style="background:#ff6ac1;" data-color="#ff6ac1"></div>
      <div class="color-swatch" style="background:#ffcc44;" data-color="#ffcc44"></div>
      <div class="color-swatch" style="background:#6affb4;" data-color="#6affb4"></div>
      <div class="color-swatch" style="background:#ff4466;" data-color="#ff4466"></div>
      <div class="color-swatch" style="background:#4af;" data-color="#4af"></div>
    </div>

    <button class="btn btn-primary" style="width:100%;" onclick="addText()">Ôºã Agregar</button>
  </div>
</div>

<!-- Loader -->
<div id="loader" class="loader-overlay">
  <div class="loader-box">
    <div class="loader-ring"></div>
    <div class="loader-title">Procesando...</div>
    <div class="loader-sub" id="loaderMsg">Aplicando efectos</div>
    <div class="progress-bar"><div class="progress-fill" id="progFill"></div></div>
  </div>
</div>

<canvas id="photoCanvas" style="display:none"></canvas>

<script>
// === STATE ===
let vEl=null, pEl=null, curVideo=null, curPhoto=null;
let vFilter='none', vEffect='none', vRot=0, vFlipH=false, vFlipV=false;
let pFilter='none', pRot=0, pFlipH=false, pFlipV=false;
let pBrightness=100, pContrast=100, pSaturate=100, pHue=0, pBlur=0;
let pEffect='none';
let clips=[], textOverlays=[], stickers=[];
let selColor='#fff', selFontSize=32;
let selQuality='1080p';
let isMuted=false;
let comparing=false;
let pOrigSrc=null;

const filterMap = {
  none:'none',
  vintage:'sepia(0.5) contrast(1.2) brightness(0.9)',
  bw:'grayscale(100%)',
  sepia:'sepia(100%)',
  cool:'hue-rotate(200deg) saturate(1.4)',
  warm:'hue-rotate(30deg) saturate(1.3) brightness(1.05)',
  vibrant:'saturate(2) contrast(1.2)',
  dramatic:'contrast(1.6) brightness(0.85) saturate(0.7)',
  cinematic:'contrast(1.15) saturate(0.85) brightness(0.95)',
  retro:'sepia(0.35) hue-rotate(-15deg) saturate(1.4)',
  nashville:'sepia(0.25) contrast(1.2) brightness(1.05) saturate(1.3)',
  lomo:'contrast(1.6) saturate(1.2) brightness(0.9)',
  fade:'brightness(1.1) saturate(0.7) contrast(0.9)',
  neon:'hue-rotate(90deg) saturate(2.5) contrast(1.3) brightness(1.1)',
  haze:'brightness(1.15) saturate(0.6) contrast(0.85)',
  muted:'saturate(0.4) contrast(1.1)'
};

const effectMap = {
  none:'',
  blur:'blur(6px)',
  sharpen:'contrast(1.8)',
  vignette:'brightness(0.7)',
  glow:'brightness(1.3) contrast(0.85)',
  pixelate:'contrast(2.5)',
  invert:'invert(100%)',
  glitch:'hue-rotate(45deg) contrast(2)',
  chromatic:'saturate(3) hue-rotate(20deg)'
};

// === TABS ===
function switchTab(tab) {
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));
  document.getElementById(tab).classList.add('active');
  if(event && event.target) event.target.classList.add('active');
  window.scrollTo({top:0,behavior:'smooth'});
}

function showVideoTab(tab) {
  document.querySelectorAll('#videoTools .panel-body').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('#video .tab-btn').forEach(b=>b.classList.remove('active'));
  const panelId = {filters:'vFilters',effects:'vEffects',adjust:'vAdjust',text:'vText',audio:'vAudio',transform:'vTransform',stickers:'vStickers',export:'vExport'}[tab];
  if(panelId) document.getElementById(panelId).classList.add('active');
  if(event && event.target) event.target.classList.add('active');
}

function showPhotoTab(tab) {
  document.querySelectorAll('#photoTools .panel-body').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('#photo .tab-btn').forEach(b=>b.classList.remove('active'));
  const panelId = {filters:'pFilters',adjust:'pAdjust',effects:'pEffects',transform:'pTransform',stickers:'pStickers',export:'pExport'}[tab];
  if(panelId) document.getElementById(panelId).classList.add('active');
  if(event && event.target) event.target.classList.add('active');
}

// === DRAG & DROP ===
function handleDragOver(e) { e.preventDefault(); e.currentTarget.classList.add('drag-over'); }
function handleDragLeave(e) { e.currentTarget.classList.remove('drag-over'); }
function handleDrop(e,type) {
  e.preventDefault();
  e.currentTarget.classList.remove('drag-over');
  const files = e.dataTransfer.files;
  if(!files.length) return;
  if(type==='video') {
    const fakeEvent = {target:{files}};
    loadVideo(fakeEvent);
  } else {
    const fakeEvent = {target:{files:[files[0]]}};
    loadPhoto(fakeEvent);
  }
}

// === VIDEO ===
function loadVideo(e) {
  const files = Array.from(e.target.files);
  if(!files.length) return;
  files.forEach(f=>clips.push({file:f, url:URL.createObjectURL(f)}));
  const clip = clips[0];
  curVideo = clip.file;
  document.getElementById('videoPreview').innerHTML = `
    <video id="vPlayer" controls style="max-width:100%;max-height:480px;object-fit:contain;border-radius:12px;" playsinline>
      <source src="${clip.url}" type="${clip.file.type}">
    </video>`;
  vEl = document.getElementById('vPlayer');
  document.getElementById('videoTimeline').style.display='block';
  document.getElementById('videoTools').style.display='block';
  document.getElementById('exportVideoFab').style.display='inline-flex';
  document.getElementById('clipCount').textContent = clips.length;
  updateClipTrack();
}

function updateClipTrack() {
  const track = document.getElementById('clipTrack');
  track.innerHTML = '';
  clips.forEach((c,i)=>{
    const div = document.createElement('div');
    div.className = 't-clip';
    div.innerHTML = `Clip ${i+1}<button class="t-clip-remove" onclick="removeClip(${i})">√ó</button>`;
    track.appendChild(div);
  });
  const add = document.createElement('div');
  add.className = 't-clip-add';
  add.textContent = 'Ôºã Clip';
  add.onclick = ()=>document.getElementById('videoInput').click();
  track.appendChild(add);
  document.getElementById('clipCount').textContent = clips.length;
}

function removeClip(i) {
  clips.splice(i,1);
  if(clips.length===0){resetVideo();return;}
  updateClipTrack();
}

function resetVideo() {
  document.getElementById('videoPreview').innerHTML = `
    <div class="drop-zone" id="videoDrop" onclick="document.getElementById('videoInput').click()"
      ondragover="handleDragOver(event)" ondrop="handleDrop(event,'video')" ondragleave="handleDragLeave(event)">
      <div class="dz-icon">üé¨</div>
      <p>Arrastra tu video aqu√≠ o toca para seleccionar</p>
      <button class="btn btn-primary" onclick="event.stopPropagation(); document.getElementById('videoInput').click()">Ôºã Seleccionar Video</button>
    </div>`;
  document.getElementById('videoTimeline').style.display='none';
  document.getElementById('videoTools').style.display='none';
  document.getElementById('exportVideoFab').style.display='none';
  clips=[];vEl=null;curVideo=null;vRot=0;vFlipH=false;vFlipV=false;
}

function applyVideoStyle() {
  if(!vEl) return;
  let f = filterMap[vFilter]||'none';
  let ef = effectMap[vEffect]||'';
  vEl.style.filter = [f,ef].filter(Boolean).join(' ');
  let t = `rotate(${vRot}deg)`;
  if(vFlipH) t += ' scaleX(-1)';
  if(vFlipV) t += ' scaleY(-1)';
  vEl.style.transform = t;
}

function setVideoFilter(f,btn) {
  vFilter=f; applyVideoStyle();
  document.querySelectorAll('#vFilters .filter-chip').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
}

function setVideoEffect(ef,btn) {
  vEffect = vEffect===ef ? 'none' : ef;
  applyVideoStyle();
  document.querySelectorAll('#vEffects .effect-chip').forEach(b=>b.classList.remove('active'));
  if(vEffect!=='none') btn.classList.add('active');
}

function setSpeed(s) {
  if(vEl) vEl.playbackRate=s;
  document.querySelectorAll('.speed-chip').forEach(b=>b.classList.remove('active'));
  event.target.classList.add('active');
}

function setVolume(input) {
  document.getElementById('volVal').textContent=input.value+'%';
  if(vEl) vEl.volume=input.value/100;
}

function muteVideo() {
  if(!vEl) return;
  isMuted=!isMuted;
  vEl.muted=isMuted;
  const btn = document.getElementById('muteBtn');
  btn.textContent = isMuted ? 'üîä Activar' : 'üîá Silenciar';
}

function setAspect(a,btn) {
  document.querySelectorAll('.aspect-chip').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  showToast(`Formato ${a} se aplicar√° al exportar`);
}

function rotateVideo(deg,reset) {
  vRot = reset==='reset' ? 0 : (vRot+deg)%360;
  applyVideoStyle();
}

function flipVideo(dir) {
  if(dir==='h') vFlipH=!vFlipH;
  else vFlipV=!vFlipV;
  applyVideoStyle();
}

function doExportVideo() {
  if(!curVideo) return showToast('Primero selecciona un video');
  showLoader('Exportando video...');
  animateProgress(()=>{
    const link=document.createElement('a');
    link.href=URL.createObjectURL(curVideo);
    link.download=`studiocut-${Date.now()}.${curVideo.name.split('.').pop()}`;
    link.click();
    hideLoader();
    showToast('‚úÖ Video exportado sin marca de agua');
  });
}

// === PHOTO ===
function loadPhoto(e) {
  const file = e.target.files[0];
  if(!file) return;
  curPhoto=file;
  const reader = new FileReader();
  reader.onload = ev => {
    pOrigSrc = ev.target.result;
    document.getElementById('photoPreview').innerHTML = `
      <img id="pImg" src="${ev.target.result}" style="max-width:100%;max-height:480px;object-fit:contain;border-radius:12px;">`;
    pEl = document.getElementById('pImg');
    document.getElementById('photoTools').style.display='block';
    document.getElementById('exportPhotoFab').style.display='inline-flex';
    resetPhotoSliders();
  };
  reader.readAsDataURL(file);
}

function resetPhotoSliders() {
  pBrightness=100;pContrast=100;pSaturate=100;pHue=0;pBlur=0;
  document.querySelectorAll('#pAdjust input[type=range]').forEach(r=>r.value=r.defaultValue);
  updatePhotoStyle();
}

function resetPhoto() {
  if(!pOrigSrc) return;
  pFilter='none'; pEffect='none'; pRot=0; pFlipH=false; pFlipV=false;
  resetPhotoSliders();
  document.querySelectorAll('#pFilters .filter-chip').forEach(b=>b.classList.remove('active'));
  document.querySelector('#pFilters .filter-chip').classList.add('active');
  comparing=false;
}

function adjustPhoto(prop,input) {
  const val = parseFloat(input.value);
  const labels = {brightness:'pBrightVal',contrast:'pContrastVal',saturate:'pSatVal',hue:'pHueVal',blur:'pBlurVal'};
  const units = {hue:'¬∞',blur:'px'};
  const unit = units[prop]||'%';
  document.getElementById(labels[prop]).textContent = val+unit;
  if(prop==='brightness') pBrightness=val;
  else if(prop==='contrast') pContrast=val;
  else if(prop==='saturate') pSaturate=val;
  else if(prop==='hue') pHue=val;
  else if(prop==='blur') pBlur=val;
  updatePhotoStyle();
}

function setPhotoFilter(f,btn) {
  pFilter=f; updatePhotoStyle();
  document.querySelectorAll('#pFilters .filter-chip').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
}

function togglePhotoEffect(ef,btn) {
  pEffect = pEffect===ef ? 'none' : ef;
  updatePhotoStyle();
  document.querySelectorAll('#pEffects .effect-chip').forEach(b=>b.classList.remove('active'));
  if(pEffect!=='none') btn.classList.add('active');
}

function updatePhotoStyle() {
  if(!pEl) return;
  let f = `brightness(${pBrightness}%) contrast(${pContrast}%) saturate(${pSaturate}%) hue-rotate(${pHue}deg) blur(${pBlur}px)`;
  if(pFilter!=='none') f += ' ' + (filterMap[pFilter]||'');
  if(pEffect!=='none') f += ' ' + (effectMap[pEffect]||'');
  pEl.style.filter = f.trim();
  let t = `rotate(${pRot}deg)`;
  if(pFlipH) t+=' scaleX(-1)';
  if(pFlipV) t+=' scaleY(-1)';
  pEl.style.transform = t;
}

function rotatePhoto(deg,reset) {
  pRot = reset==='reset' ? 0 : (pRot+deg)%360;
  updatePhotoStyle();
}

function flipPhoto(dir) {
  if(dir==='h') pFlipH=!pFlipH;
  else pFlipV=!pFlipV;
  updatePhotoStyle();
}

function comparePhoto() {
  if(!pEl||!pOrigSrc) return;
  comparing=!comparing;
  if(comparing) {
    pEl.style.filter='none';
    pEl.style.transform='none';
    document.getElementById('compareBtn').style.color='var(--accent)';
  } else {
    updatePhotoStyle();
    document.getElementById('compareBtn').style.color='';
  }
}

function notifySticker(emoji) {
  showToast(`${emoji} Sticker agregado`);
}

function doExportPhoto() {
  if(!pEl) return showToast('Primero selecciona una foto');
  showLoader('Exportando foto...');
  animateProgress(()=>{
    const canvas = document.getElementById('photoCanvas');
    const ctx = canvas.getContext('2d');
    const img = pEl;
    const sizes = {'720p':{w:1280,h:720},'1080p':{w:1920,h:1080},'4k':{w:3840,h:2160}};
    const size = sizes[selQuality];
    const ratio = img.naturalWidth/img.naturalHeight;
    if(ratio>size.w/size.h){canvas.width=size.w;canvas.height=size.w/ratio;}
    else{canvas.height=size.h;canvas.width=size.h*ratio;}
    ctx.filter = pEl.style.filter;
    ctx.save();
    ctx.translate(canvas.width/2,canvas.height/2);
    ctx.rotate(pRot*Math.PI/180);
    if(pFlipH) ctx.scale(-1,1);
    if(pFlipV) ctx.scale(1,-1);
    ctx.translate(-canvas.width/2,-canvas.height/2);
    ctx.drawImage(img,0,0,canvas.width,canvas.height);
    ctx.restore();
    canvas.toBlob(blob=>{
      const link=document.createElement('a');
      link.href=URL.createObjectURL(blob);
      link.download=`studiocut-${Date.now()}.jpg`;
      link.click();
      hideLoader();
      showToast('‚úÖ Foto guardada sin marca de agua');
    },'image/jpeg',0.95);
  });
}

// === TEXT ===
function openTextModal() {
  document.getElementById('textInput').value='';
  document.getElementById('textModal').classList.add('active');
}

document.querySelectorAll('.color-swatch').forEach(s=>{
  s.addEventListener('click',function(){
    document.querySelectorAll('.color-swatch').forEach(x=>x.classList.remove('active'));
    this.classList.add('active');
    selColor=this.dataset.color;
  });
});

function addText() {
  const txt = document.getElementById('textInput').value.trim();
  if(!txt) return showToast('Escribe un texto primero');
  textOverlays.push({id:Date.now(),text:txt,color:selColor,size:selFontSize});
  renderTextList();
  document.getElementById('textModal').classList.remove('active');
  showToast('‚úÖ Texto agregado');
}

function renderTextList() {
  const list = document.getElementById('textList');
  if(!textOverlays.length){list.innerHTML='';return;}
  list.innerHTML = textOverlays.map(t=>`
    <div class="overlay-item">
      <span class="overlay-text" style="color:${t.color};font-size:${Math.min(t.size,20)}px;">${t.text}</span>
      <button class="overlay-del" onclick="removeText(${t.id})">‚úï</button>
    </div>`).join('');
}

function removeText(id) {
  textOverlays=textOverlays.filter(t=>t.id!==id);
  renderTextList();
}

// === STICKERS ===
function addSticker(emoji) { showToast(`${emoji} Sticker agregado al video`); }

// === AUDIO ===
function loadAudio(e) {
  const file=e.target.files[0];
  if(!file) return;
  showToast(`üéµ M√∫sica: ${file.name}`);
}

// === COLLAGE ===
function loadCollage(e) {
  const files=e.target.files;
  if(files.length<2) return showToast('Selecciona al menos 2 fotos');
  showToast(`‚úÖ ${files.length} fotos cargadas`);
}

// === QUALITY ===
function setQuality(q,el) {
  selQuality=q;
  const parent = el.closest('.quality-list');
  parent.querySelectorAll('.quality-item').forEach(i=>i.classList.remove('active'));
  el.classList.add('active');
}

// === TOOLS ===
function toolAlert(name) { showToast(`üõ†Ô∏è ${name} ‚Äî pr√≥ximamente disponible`); }

// === TOAST ===
let toastTimeout;
function showToast(msg) {
  let toast = document.getElementById('toast');
  if(!toast) {
    toast = document.createElement('div');
    toast.id = 'toast';
    toast.style.cssText = `
      position:fixed;bottom:80px;left:50%;transform:translateX(-50%);
      background:rgba(30,30,40,0.95);border:1px solid rgba(255,255,255,0.12);
      color:#f0f0f8;padding:12px 24px;border-radius:12px;font-size:0.9em;
      font-weight:500;z-index:9998;pointer-events:none;
      box-shadow:0 8px 24px rgba(0,0,0,0.4);
      font-family:'DM Sans',sans-serif;
      transition:opacity 0.3s;white-space:nowrap;
    `;
    document.body.appendChild(toast);
  }
  toast.textContent = msg;
  toast.style.opacity = '1';
  clearTimeout(toastTimeout);
  toastTimeout = setTimeout(()=>{toast.style.opacity='0';},2800);
}

// === LOADER ===
function showLoader(msg) {
  document.getElementById('loaderMsg').textContent = msg||'Procesando';
  document.getElementById('progFill').style.width='0%';
  document.getElementById('loader').classList.add('active');
}

function hideLoader() {
  document.getElementById('loader').classList.remove('active');
}

function animateProgress(cb) {
  let p=0;
  const id=setInterval(()=>{
    p+=Math.random()*15;
    if(p>95)p=95;
    document.getElementById('progFill').style.width=p+'%';
  },200);
  setTimeout(()=>{
    clearInterval(id);
    document.getElementById('progFill').style.width='100%';
    setTimeout(cb,400);
  },2000);
}
</script>
</body>
</html>
              <input type="range" min="0" max="360" value="0" oninput="adjustPhoto('hue',this)">
            </div>
            <div class="slider-row">
              <div class="slider-header"><span class="slider-name">üí´ Blur</span><span class="slider-val" id="pBlurVal">0px</span></div>
              <input type="range" min="0" max="20" value="0" oninput="adjustPhoto('blur',this)">
            </div>
          </div>
        </div>

        <!-- Effects -->
        <div id="pEffects" class="panel-body">
          <div class="panel-section">
            <div class="panel-label">Efectos Visuales</div>
            <div class="filter-grid">
              <button class="effect-chip" onclick="togglePhotoEffect('vignette',this)"><div>üåë</div>Vignette</button>
              <button class="effect-chip" onclick="togglePhotoEffect('sharpen',this)"><div>üîç</div>Sharpen</button>
              <button class="effect-chip" onclick="togglePhotoEffect('glow',this)"><div>‚ú®</div>Glow</button>
              <button class="effect-chip" onclick="togglePhotoEffect('invert',this)"><div>üîÑ</div>Invert</button>
            </div>
          </div>
        </div>

        <!-- Transform -->
        <div id="pTransform" class="panel-body">
          <div class="panel-section">
            <div class="panel-label">Rotaci√≥n</div>
            <div class="transform-grid">
              <button class="transform-chip" onclick="rotatePhoto(-90)">‚Ü∂ ‚àí90¬∞</button>
              <button class="transform-chip" onclick="rotatePhoto(90)">‚Ü∑ +90¬∞</button>
              <button class="transform-chip" onclick="rotatePhoto(180)">‚Üª 180¬∞</button>
              <button class="transform-chip" onclick="rotatePhoto(0,'reset')">‚äô Reset</button>
            </div>
          </div>
          <div class="sep"></div>
          <div class="panel-section">
            <div class="panel-label">Voltear</div>
            <div class="transform-grid">
              <button class="transform-chip" onclick="flipPhoto('h')">‚Üî Horizontal</button>
              <button class="transform-chip" onclick="flipPhoto('v')">‚Üï Vertical</button>
            </div>
          </div>
        </div>

        <!-- Stickers -->
        <div id="pStickers" class="panel-body">
          <div class="panel-section">
            <div class="panel-label">Emojis & Stickers</div>
            <div class="sticker-grid">
              <button class="sticker-chip" onclick="notifySticker('‚ù§Ô∏è')">‚ù§Ô∏è</button>
              <button class="sticker-chip" onclick="notifySticker('üî•')">üî•</button>
              <button class="sticker-chip" onclick="notifySticker('‚≠ê')">‚≠ê</button>
              <button class="sticker-chip" onclick="notifySticker('üíØ')">üíØ</button>
              <button class="sticker-chip" onclick="notifySticker('‚ú®')">‚ú®</button>
              <button class="sticker-chip" onclick="notifySticker('üéâ')">üéâ</button>
              <button class="sticker-chip" onclick="notifySticker('üòç')">üòç</button>
              <button class="sticker-chip" onclick="notifySticker('üåü')">üåü</button>
              <button class="sticker-chip" onclick="notifySticker('ü¶ã')">ü¶ã</button>
              <button class="sticker-chip" onclick="notifySticker('üåà')">üåà</button>
              <button class="sticker-chip" onclick="notifySticker('üéµ')">üéµ</button>
              <button class="sticker-chip" onclick="notifySticker('üèÜ')">üèÜ</button>
            </div>
          </div>
        </div>

        <!-- Export -->
        <div id="pExport" class="panel-body">
          <div class="panel-section">
            <div class="panel-label">Calidad de Exportaci√≥n</div>
            <div class="quality-list">
              <div class="quality-item" onclick="setQuality('720p',this)">
                <div class="q-radio"></div>
                <div class="q-info"><h4>720p</h4><p>1280√ó720</p></div>
              </div>
              <div class="quality-item active" onclick="setQuality('1080p',this)">
                <div class="q-radio"></div>
                <div class="q-info"><h4>1080p Full HD</h4><p>1920√ó1080</p></div>
              </div>
              <div class="quality-item" onclick="setQuality('4k',this)">
                <div class="q-radio"></div>
                <div class="q-info"><h4>4K</h4><p>3840√ó2160</p></div>
              </div>
            </div>
            <div class="sep"></div>
            <button class="btn btn-success" style="width:100%;" onclick="doExportPhoto()">
              üíæ Guardar Foto Sin Marca de Agua
            </button>
          </div>
        </div>
      </div>

      <div class="action-row">
        <label for="photoInput" class="btn btn-ghost">üîÑ Cambiar</label>
        <button class="btn btn-success" id="exportPhotoFab" style="display:none" onclick="showPhotoTab('export'); document.querySelectorAll('#photo .tab-btn')[5].classList.add('active')">üíæ Guardar</button>
      </div>
    </div>
  </div>

  <!-- COLLAGE -->
  <div id="collage" class="section">
    <div style="text-align:center; padding:clamp(30px,6vw,60px) 20px;">
      <div style="font-size:clamp(2.5em,8vw,4em); margin-bottom:20px;">üñºÔ∏è</div>
      <h2 style="font-family:'Syne',sans-serif; font-size:clamp(1.5em,4vw,2.2em); font-weight:800; margin-bottom:12px;">Creador de Collage</h2>
      <p style="color:var(--text2); margin-bottom:40px;">Combina m√∫ltiples fotos en un solo dise√±o</p>
      <div class="cards-grid" style="max-width:700px; margin:0 auto 40px;">
        <div class="card" onclick="document.getElementById('collageInput').click()">
          <span class="card-icon">‚¨õ‚¨ú</span>
          <h3>2 Fotos</h3>
          <p>Dise√±o lado a lado</p>
        </div>
        <div class="card" onclick="document.getElementById('collageInput').click()">
          <span class="card-icon">‚ñ™Ô∏è‚ñ™Ô∏è</span>
          <h3>4 Fotos</h3>
          <p>Grid cuadrado</p>
        </div>
        <div class="card" onclick="document.getElementById('collageInput').click()">
          <span class="card-icon">‚ñ™Ô∏è‚ñ™Ô∏è‚ñ™Ô∏è</span>
          <h3>9 Fotos</h3>
          <p>Grid Instagram</p>
        </div>
      </div>
      <label for="collageInput" class="btn btn-primary">Ôºã Seleccionar Fotos</label>
    </div>
  </div>

  <!-- GIF -->
  <div id="gif" class="section">
    <div style="text-align:center; padding:clamp(30px,6vw,60px) 20px;">
      <div style="font-size:clamp(2.5em,8vw,4em); margin-bottom:20px;">üéûÔ∏è</div>
      <h2 style="font-family:'Syne',sans-serif; font-size:clamp(1.5em,4vw,2.2em); font-weight:800; margin-bottom:12px;">GIF Maker</h2>
      <p style="color:var(--text2); margin-bottom:40px;">Convierte tus videos en GIFs animados optimizados</p>
      <div class="stats-row" style="max-width:500px; margin:0 auto 40px;">
        <div class="stat"><div class="stat-num">‚ö°</div><div class="stat-label">Instant√°neo</div></div>
        <div class="stat"><div class="stat-num">üé®</div><div class="stat-label">Personalizable</div></div>
        <div class="stat"><div class="stat-num">üíæ</div><div class="stat-label">Optimizado</div></div>
      </div>
      <label for="gifInput" class="btn btn-primary">üé• Seleccionar Video</label>
    </div>
  </div>

  <!-- TOOLS -->
  <div id="tools" class="section">
    <h2 style="font-family:'Syne',sans-serif; font-size:clamp(1.3em,4vw,1.8em); font-weight:800; margin-bottom:24px;">üõ†Ô∏è Herramientas</h2>
    <div class="cards-grid">
      <div class="card" onclick="toolAlert('Conversor de Formato')">
        <span class="card-icon">üîÑ</span>
        <h3>Conversor</h3>
        <p>Convierte entre MP4, MOV, AVI, WebM</p>
      </div>
      <div class="card" onclick="toolAlert('Compresor de Video')">
        <span class="card-icon">üì¶</span>
        <h3>Compresor</h3>
        <p>Reduce tama√±o sin perder calidad</p>
      </div>
      <div class="card" onclick="toolAlert('Unidor de Videos')">
        <span class="card-icon">‚ûï</span>
        <h3>Unir Videos</h3>
        <p>Combina m√∫ltiples clips</p>
      </div>
      <div class="card" onclick="toolAlert('Recortador de Video')">
        <span class="card-icon">‚úÇÔ∏è</span>
        <h3>Recortar</h3>
        <p>Selecciona el segmento exacto</p>
      </div>
      <div class="card" onclick="toolAlert('Extractor de Audio')">
        <span class="card-icon">üéµ</span>
        <h3>Extraer Audio</h3>
        <p>Obt√©n MP3 de tus videos</p>
      </div>
      <div class="card" onclick="toolAlert('Marca de Agua')">
        <span class="card-icon">¬©Ô∏è</span>
        <h3>Marca de Agua</h3>
        <p>Agrega tu logo o texto</p>
      </div>
    </div>
  </div>

</div><!-- /content -->

<!-- FAB -->
<button class="fab" onclick="window.scrollTo({top:0,behavior:'smooth'})">‚¨Ü</button>

<!-- Hidden Inputs -->
<input type="file" id="videoInput" accept="video/*" multiple onchange="loadVideo(event)">
<input type="file" id="photoInput" accept="image/*" onchange="loadPhoto(event)">
<input type="file" id="audioInput" accept="audio/*" onchange="loadAudio(event)">
<input type="file" id="collageInput" accept="image/*" multiple onchange="loadCollage(event)">
<input type="file" id="gifInput" accept="video/*" onchange="alert('üéûÔ∏è Video cargado. GIF Maker en desarrollo.')">

<!-- Text Modal -->
<div id="textModal" class="modal">
  <div class="modal-box">
    <div class="modal-header">
      <div class="modal-title">‚úèÔ∏è Agregar Texto</div>
      <button class="modal-close" onclick="document.getElementById('textModal').classList.remove('active')">‚úï</button>
    </div>

    <div class="panel-label" style="margin-bottom:10px;">Texto</div>
    <textarea id="textInput" placeholder="Escribe tu texto aqu√≠..."></textarea>

    <div class="sep"></div>

    <div class="panel-label">Tama√±o</div>
    <div class="slider-row">
      <div class="slider-header"><span class="slider-name">Fuente</span><span class="slider-val" id="fontSzVal">32px</span></div>
      <input type="range" min="12" max="80" value="32" oninput="document.getElementById('fontSzVal').textContent=this.value+'px'; selFontSize=this.value">
    </div>

    <div class="sep"></div>

    <div class="panel-label">Color</div>
    <div class="color-grid" style="margin-bottom:20px;">
      <div class="color-swatch active" style="background:#fff;" data-color="#fff"></div>
      <div class="color-swatch" style="background:#000;" data-color="#000"></div>
      <div class="color-swatch" style="background:#7c6aff;" data-color="#7c6aff"></div>
      <div class="color-swatch" style="background:#ff6ac1;" data-color="#ff6ac1"></div>
      <div class="color-swatch" style="background:#ffcc44;" data-color="#ffcc44"></div>
      <div class="color-swatch" style="background:#6affb4;" data-color="#6affb4"></div>
      <div class="color-swatch" style="background:#ff4466;" data-color="#ff4466"></div>
      <div class="color-swatch" style="background:#4af;" data-color="#4af"></div>
    </div>

    <button class="btn btn-primary" style="width:100%;" onclick="addText()">Ôºã Agregar</button>
  </div>
</div>

<!-- Loader -->
<div id="loader" class="loader-overlay">
  <div class="loader-box">
    <div class="loader-ring"></div>
    <div class="loader-title">Procesando...</div>
    <div class="loader-sub" id="loaderMsg">Aplicando efectos</div>
    <div class="progress-bar"><div class="progress-fill" id="progFill"></div></div>
  </div>
</div>

<canvas id="photoCanvas" style="display:none"></canvas>

<script>
// === STATE ===
let vEl=null, pEl=null, curVideo=null, curPhoto=null;
let vFilter='none', vEffect='none', vRot=0, vFlipH=false, vFlipV=false;
let pFilter='none', pRot=0, pFlipH=false, pFlipV=false;
let pBrightness=100, pContrast=100, pSaturate=100, pHue=0, pBlur=0;
let pEffect='none';
let clips=[], textOverlays=[], stickers=[];
let selColor='#fff', selFontSize=32;
let selQuality='1080p';
let isMuted=false;
let comparing=false;
let pOrigSrc=null;

const filterMap = {
  none:'none',
  vintage:'sepia(0.5) contrast(1.2) brightness(0.9)',
  bw:'grayscale(100%)',
  sepia:'sepia(100%)',
  cool:'hue-rotate(200deg) saturate(1.4)',
  warm:'hue-rotate(30deg) saturate(1.3) brightness(1.05)',
  vibrant:'saturate(2) contrast(1.2)',
  dramatic:'contrast(1.6) brightness(0.85) saturate(0.7)',
  cinematic:'contrast(1.15) saturate(0.85) brightness(0.95)',
  retro:'sepia(0.35) hue-rotate(-15deg) saturate(1.4)',
  nashville:'sepia(0.25) contrast(1.2) brightness(1.05) saturate(1.3)',
  lomo:'contrast(1.6) saturate(1.2) brightness(0.9)',
  fade:'brightness(1.1) saturate(0.7) contrast(0.9)',
  neon:'hue-rotate(90deg) saturate(2.5) contrast(1.3) brightness(1.1)',
  haze:'brightness(1.15) saturate(0.6) contrast(0.85)',
  muted:'saturate(0.4) contrast(1.1)'
};

const effectMap = {
  none:'',
  blur:'blur(6px)',
  sharpen:'contrast(1.8)',
  vignette:'brightness(0.7)',
  glow:'brightness(1.3) contrast(0.85)',
  pixelate:'contrast(2.5)',
  invert:'invert(100%)',
  glitch:'hue-rotate(45deg) contrast(2)',
  chromatic:'saturate(3) hue-rotate(20deg)'
};

// === TABS ===
function switchTab(tab) {
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));
  document.getElementById(tab).classList.add('active');
  if(event && event.target) event.target.classList.add('active');
  window.scrollTo({top:0,behavior:'smooth'});
}

function showVideoTab(tab) {
  document.querySelectorAll('#videoTools .panel-body').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('#video .tab-btn').forEach(b=>b.classList.remove('active'));
  const panelId = {filters:'vFilters',effects:'vEffects',adjust:'vAdjust',text:'vText',audio:'vAudio',transform:'vTransform',stickers:'vStickers',export:'vExport'}[tab];
  if(panelId) document.getElementById(panelId).classList.add('active');
  if(event && event.target) event.target.classList.add('active');
}

function showPhotoTab(tab) {
  document.querySelectorAll('#photoTools .panel-body').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('#photo .tab-btn').forEach(b=>b.classList.remove('active'));
  const panelId = {filters:'pFilters',adjust:'pAdjust',effects:'pEffects',transform:'pTransform',stickers:'pStickers',export:'pExport'}[tab];
  if(panelId) document.getElementById(panelId).classList.add('active');
  if(event && event.target) event.target.classList.add('active');
}

// === DRAG & DROP ===
function handleDragOver(e) { e.preventDefault(); e.currentTarget.classList.add('drag-over'); }
function handleDragLeave(e) { e.currentTarget.classList.remove('drag-over'); }
function handleDrop(e,type) {
  e.preventDefault();
  e.currentTarget.classList.remove('drag-over');
  const files = e.dataTransfer.files;
  if(!files.length) return;
  if(type==='video') {
    const fakeEvent = {target:{files}};
    loadVideo(fakeEvent);
  } else {
    const fakeEvent = {target:{files:[files[0]]}};
    loadPhoto(fakeEvent);
  }
}

// === VIDEO ===
function loadVideo(e) {
  const files = Array.from(e.target.files);
  if(!files.length) return;
  files.forEach(f=>clips.push({file:f, url:URL.createObjectURL(f)}));
  const clip = clips[0];
  curVideo = clip.file;
  document.getElementById('videoPreview').innerHTML = `
    <video id="vPlayer" controls style="max-width:100%;max-height:480px;object-fit:contain;border-radius:12px;" playsinline>
      <source src="${clip.url}" type="${clip.file.type}">
    </video>`;
  vEl = document.getElementById('vPlayer');
  document.getElementById('videoTimeline').style.display='block';
  document.getElementById('videoTools').style.display='block';
  document.getElementById('exportVideoFab').style.display='inline-flex';
  document.getElementById('clipCount').textContent = clips.length;
  updateClipTrack();
}

function updateClipTrack() {
  const track = document.getElementById('clipTrack');
  track.innerHTML = '';
  clips.forEach((c,i)=>{
    const div = document.createElement('div');
    div.className = 't-clip';
    div.innerHTML = `Clip ${i+1}<button class="t-clip-remove" onclick="removeClip(${i})">√ó</button>`;
    track.appendChild(div);
  });
  const add = document.createElement('div');
  add.className = 't-clip-add';
  add.textContent = 'Ôºã Clip';
  add.onclick = ()=>document.getElementById('videoInput').click();
  track.appendChild(add);
  document.getElementById('clipCount').textContent = clips.length;
}

function removeClip(i) {
  clips.splice(i,1);
  if(clips.length===0){resetVideo();return;}
  updateClipTrack();
}

function resetVideo() {
  document.getElementById('videoPreview').innerHTML = `
    <div class="drop-zone" id="videoDrop" onclick="document.getElementById('videoInput').click()"
      ondragover="handleDragOver(event)" ondrop="handleDrop(event,'video')" ondragleave="handleDragLeave(event)">
      <div class="dz-icon">üé¨</div>
      <p>Arrastra tu video aqu√≠ o toca para seleccionar</p>
      <button class="btn btn-primary" onclick="event.stopPropagation(); document.getElementById('videoInput').click()">Ôºã Seleccionar Video</button>
    </div>`;
  document.getElementById('videoTimeline').style.display='none';
  document.getElementById('videoTools').style.display='none';
  document.getElementById('exportVideoFab').style.display='none';
  clips=[];vEl=null;curVideo=null;vRot=0;vFlipH=false;vFlipV=false;
}

function applyVideoStyle() {
  if(!vEl) return;
  let f = filterMap[vFilter]||'none';
  let ef = effectMap[vEffect]||'';
  vEl.style.filter = [f,ef].filter(Boolean).join(' ');
  let t = `rotate(${vRot}deg)`;
  if(vFlipH) t += ' scaleX(-1)';
  if(vFlipV) t += ' scaleY(-1)';
  vEl.style.transform = t;
}

function setVideoFilter(f,btn) {
  vFilter=f; applyVideoStyle();
  document.querySelectorAll('#vFilters .filter-chip').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
}

function setVideoEffect(ef,btn) {
  vEffect = vEffect===ef ? 'none' : ef;
  applyVideoStyle();
  document.querySelectorAll('#vEffects .effect-chip').forEach(b=>b.classList.remove('active'));
  if(vEffect!=='none') btn.classList.add('active');
}

function setSpeed(s) {
  if(vEl) vEl.playbackRate=s;
  document.querySelectorAll('.speed-chip').forEach(b=>b.classList.remove('active'));
  event.target.classList.add('active');
}

function setVolume(input) {
  document.getElementById('volVal').textContent=input.value+'%';
  if(vEl) vEl.volume=input.value/100;
}

function muteVideo() {
  if(!vEl) return;
  isMuted=!isMuted;
  vEl.muted=isMuted;
  const btn = document.getElementById('muteBtn');
  btn.textContent = isMuted ? 'üîä Activar' : 'üîá Silenciar';
}

function setAspect(a,btn) {
  document.querySelectorAll('.aspect-chip').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  showToast(`Formato ${a} se aplicar√° al exportar`);
}

function rotateVideo(deg,reset) {
  vRot = reset==='reset' ? 0 : (vRot+deg)%360;
  applyVideoStyle();
}

function flipVideo(dir) {
  if(dir==='h') vFlipH=!vFlipH;
  else vFlipV=!vFlipV;
  applyVideoStyle();
}

function doExportVideo() {
  if(!curVideo) return showToast('Primero selecciona un video');
  showLoader('Exportando video...');
  animateProgress(()=>{
    const link=document.createElement('a');
    link.href=URL.createObjectURL(curVideo);
    link.download=`studiocut-${Date.now()}.${curVideo.name.split('.').pop()}`;
    link.click();
    hideLoader();
    showToast('‚úÖ Video exportado sin marca de agua');
  });
}

// === PHOTO ===
function loadPhoto(e) {
  const file = e.target.files[0];
  if(!file) return;
  curPhoto=file;
  const reader = new FileReader();
  reader.onload = ev => {
    pOrigSrc = ev.target.result;
    document.getElementById('photoPreview').innerHTML = `
      <img id="pImg" src="${ev.target.result}" style="max-width:100%;max-height:480px;object-fit:contain;border-radius:12px;">`;
    pEl = document.getElementById('pImg');
    document.getElementById('photoTools').style.display='block';
    document.getElementById('exportPhotoFab').style.display='inline-flex';
    resetPhotoSliders();
  };
  reader.readAsDataURL(file);
}

function resetPhotoSliders() {
  pBrightness=100;pContrast=100;pSaturate=100;pHue=0;pBlur=0;
  document.querySelectorAll('#pAdjust input[type=range]').forEach(r=>r.value=r.defaultValue);
  updatePhotoStyle();
}

function resetPhoto() {
  if(!pOrigSrc) return;
  pFilter='none'; pEffect='none'; pRot=0; pFlipH=false; pFlipV=false;
  resetPhotoSliders();
  document.querySelectorAll('#pFilters .filter-chip').forEach(b=>b.classList.remove('active'));
  document.querySelector('#pFilters .filter-chip').classList.add('active');
  comparing=false;
}

function adjustPhoto(prop,input) {
  const val = parseFloat(input.value);
  const labels = {brightness:'pBrightVal',contrast:'pContrastVal',saturate:'pSatVal',hue:'pHueVal',blur:'pBlurVal'};
  const units = {hue:'¬∞',blur:'px'};
  const unit = units[prop]||'%';
  document.getElementById(labels[prop]).textContent = val+unit;
  if(prop==='brightness') pBrightness=val;
  else if(prop==='contrast') pContrast=val;
  else if(prop==='saturate') pSaturate=val;
  else if(prop==='hue') pHue=val;
  else if(prop==='blur') pBlur=val;
  updatePhotoStyle();
}

function setPhotoFilter(f,btn) {
  pFilter=f; updatePhotoStyle();
  document.querySelectorAll('#pFilters .filter-chip').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
}

function togglePhotoEffect(ef,btn) {
  pEffect = pEffect===ef ? 'none' : ef;
  updatePhotoStyle();
  document.querySelectorAll('#pEffects .effect-chip').forEach(b=>b.classList.remove('active'));
  if(pEffect!=='none') btn.classList.add('active');
}

function updatePhotoStyle() {
  if(!pEl) return;
  let f = `brightness(${pBrightness}%) contrast(${pContrast}%) saturate(${pSaturate}%) hue-rotate(${pHue}deg) blur(${pBlur}px)`;
  if(pFilter!=='none') f += ' ' + (filterMap[pFilter]||'');
  if(pEffect!=='none') f += ' ' + (effectMap[pEffect]||'');
  pEl.style.filter = f.trim();
  let t = `rotate(${pRot}deg)`;
  if(pFlipH) t+=' scaleX(-1)';
  if(pFlipV) t+=' scaleY(-1)';
  pEl.style.transform = t;
}

function rotatePhoto(deg,reset) {
  pRot = reset==='reset' ? 0 : (pRot+deg)%360;
  updatePhotoStyle();
}

function flipPhoto(dir) {
  if(dir==='h') pFlipH=!pFlipH;
  else pFlipV=!pFlipV;
  updatePhotoStyle();
}

function comparePhoto() {
  if(!pEl||!pOrigSrc) return;
  comparing=!comparing;
  if(comparing) {
    pEl.style.filter='none';
    pEl.style.transform='none';
    document.getElementById('compareBtn').style.color='var(--accent)';
  } else {
    updatePhotoStyle();
    document.getElementById('compareBtn').style.color='';
  }
}

function notifySticker(emoji) {
  showToast(`${emoji} Sticker agregado`);
}

function doExportPhoto() {
  if(!pEl) return showToast('Primero selecciona una foto');
  showLoader('Exportando foto...');
  animateProgress(()=>{
    const canvas = document.getElementById('photoCanvas');
    const ctx = canvas.getContext('2d');
    const img = pEl;
    const sizes = {'720p':{w:1280,h:720},'1080p':{w:1920,h:1080},'4k':{w:3840,h:2160}};
    const size = sizes[selQuality];
    const ratio = img.naturalWidth/img.naturalHeight;
    if(ratio>size.w/size.h){canvas.width=size.w;canvas.height=size.w/ratio;}
    else{canvas.height=size.h;canvas.width=size.h*ratio;}
    ctx.filter = pEl.style.filter;
    ctx.save();
    ctx.translate(canvas.width/2,canvas.height/2);
    ctx.rotate(pRot*Math.PI/180);
    if(pFlipH) ctx.scale(-1,1);
    if(pFlipV) ctx.scale(1,-1);
    ctx.translate(-canvas.width/2,-canvas.height/2);
    ctx.drawImage(img,0,0,canvas.width,canvas.height);
    ctx.restore();
    canvas.toBlob(blob=>{
      const link=document.createElement('a');
      link.href=URL.createObjectURL(blob);
      link.download=`studiocut-${Date.now()}.jpg`;
      link.click();
      hideLoader();
      showToast('‚úÖ Foto guardada sin marca de agua');
    },'image/jpeg',0.95);
  });
}

// === TEXT ===
function openTextModal() {
  document.getElementById('textInput').value='';
  document.getElementById('textModal').classList.add('active');
}

document.querySelectorAll('.color-swatch').forEach(s=>{
  s.addEventListener('click',function(){
    document.querySelectorAll('.color-swatch').forEach(x=>x.classList.remove('active'));
    this.classList.add('active');
    selColor=this.dataset.color;
  });
});

function addText() {
  const txt = document.getElementById('textInput').value.trim();
  if(!txt) return showToast('Escribe un texto primero');
  textOverlays.push({id:Date.now(),text:txt,color:selColor,size:selFontSize});
  renderTextList();
  document.getElementById('textModal').classList.remove('active');
  showToast('‚úÖ Texto agregado');
}

function renderTextList() {
  const list = document.getElementById('textList');
  if(!textOverlays.length){list.innerHTML='';return;}
  list.innerHTML = textOverlays.map(t=>`
    <div class="overlay-item">
      <span class="overlay-text" style="color:${t.color};font-size:${Math.min(t.size,20)}px;">${t.text}</span>
      <button class="overlay-del" onclick="removeText(${t.id})">‚úï</button>
    </div>`).join('');
}

function removeText(id) {
  textOverlays=textOverlays.filter(t=>t.id!==id);
  renderTextList();
}

// === STICKERS ===
function addSticker(emoji) { showToast(`${emoji} Sticker agregado al video`); }

// === AUDIO ===
function loadAudio(e) {
  const file=e.target.files[0];
  if(!file) return;
  showToast(`üéµ M√∫sica: ${file.name}`);
}

// === COLLAGE ===
function loadCollage(e) {
  const files=e.target.files;
  if(files.length<2) return showToast('Selecciona al menos 2 fotos');
  showToast(`‚úÖ ${files.length} fotos cargadas`);
}

// === QUALITY ===
function setQuality(q,el) {
  selQuality=q;
  const parent = el.closest('.quality-list');
  parent.querySelectorAll('.quality-item').forEach(i=>i.classList.remove('active'));
  el.classList.add('active');
}

// === TOOLS ===
function toolAlert(name) { showToast(`üõ†Ô∏è ${name} ‚Äî pr√≥ximamente disponible`); }

// === TOAST ===
let toastTimeout;
function showToast(msg) {
  let toast = document.getElementById('toast');
  if(!toast) {
    toast = document.createElement('div');
    toast.id = 'toast';
    toast.style.cssText = `
      position:fixed;bottom:80px;left:50%;transform:translateX(-50%);
      background:rgba(30,30,40,0.95);border:1px solid rgba(255,255,255,0.12);
      color:#f0f0f8;padding:12px 24px;border-radius:12px;font-size:0.9em;
      font-weight:500;z-index:9998;pointer-events:none;
      box-shadow:0 8px 24px rgba(0,0,0,0.4);
      font-family:'DM Sans',sans-serif;
      transition:opacity 0.3s;white-space:nowrap;
    `;
    document.body.appendChild(toast);
  }
  toast.textContent = msg;
  toast.style.opacity = '1';
  clearTimeout(toastTimeout);
  toastTimeout = setTimeout(()=>{toast.style.opacity='0';},2800);
}

// === LOADER ===
function showLoader(msg) {
  document.getElementById('loaderMsg').textContent = msg||'Procesando';
  document.getElementById('progFill').style.width='0%';
  document.getElementById('loader').classList.add('active');
}

function hideLoader() {
  document.getElementById('loader').classList.remove('active');
}

function animateProgress(cb) {
  let p=0;
  const id=setInterval(()=>{
    p+=Math.random()*15;
    if(p>95)p=95;
    document.getElementById('progFill').style.width=p+'%';
  },200);
  setTimeout(()=>{
    clearInterval(id);
    document.getElementById('progFill').style.width='100%';
    setTimeout(cb,400);
  },2000);
}
</script>
</body>
</html>
                <div class="color-option" style="background: #000000;" data-color="#000000"></div>
                <div class="color-option" style="background: #FF6B6B;" data-color="#FF6B6B"></div>
                <div class="color-option" style="background: #4ECDC4;" data-color="#4ECDC4"></div>
                <div class="color-option" style="background: #FFD93D;" data-color="#FFD93D"></div>
                <div class="color-option" style="background: #6BCB77;" data-color="#6BCB77"></div>
                <div class="color-option" style="background: #4D96FF;" data-color="#4D96FF"></div>
                <div class="color-option" style="background: #FF8ED4;" data-color="#FF8ED4"></div>
            </div>

            <div class="action-buttons" style="margin-top: 25px;">
                <button class="btn btn-primary" onclick="addTextOverlay()">
                    ‚úÖ Agregar
                </button>
            </div>
        </div>
    </div>

    <!-- Export Modal -->
    <div id="exportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üíæ Exportar</h3>
                <button class="close-btn" onclick="closeExportModal()">‚úï</button>
            </div>
            
            <h4 style="margin-bottom: 15px; color: #333;">Calidad de Exportaci√≥n:</h4>
            <div class="quality-options">
                <div class="quality-option" onclick="selectQuality('720p')">
                    <div class="quality-radio"></div>
                    <div class="quality-info">
                        <h4>720p HD</h4>
                        <p>Buena calidad, archivos m√°s peque√±os (1280x720)</p>
                    </div>
                </div>
                <div class="quality-option active" onclick="selectQuality('1080p')">
                    <div class="quality-radio"></div>
                    <div class="quality-info">
                        <h4>1080p Full HD</h4>
                        <p>Alta calidad recomendada (1920x1080)</p>
                    </div>
                </div>
                <div class="quality-option" onclick="selectQuality('4k')">
                    <div class="quality-radio"></div>
                    <div class="quality-info">
                        <h4>4K Ultra HD</h4>
                        <p>M√°xima calidad, archivos grandes (3840x2160)</p>
                    </div>
                </div>
            </div>

            <div style="background: #f0f8ff; padding: 15px; border-radius: 10px; margin: 20px 0;">
                <h4 style="color: #333; margin-bottom: 10px;">‚ú® Tu exportaci√≥n incluye:</h4>
                <div class="feature-item">
                    <span class="check-icon">‚úì</span>
                    <span>Sin marca de agua</span>
                </div>
                <div class="feature-item">
                    <span class="check-icon">‚úì</span>
                    <span>Todos los efectos y filtros aplicados</span>
                </div>
                <div class="feature-item">
                    <span class="check-icon">‚úì</span>
                    <span>Calidad profesional</span>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-success" onclick="processExport()">
                    üöÄ Exportar Ahora
                </button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <h2>Procesando...</h2>
            <p id="loadingText">Aplicando efectos y exportando</p>
        </div>
    </div>

    <!-- Canvas for image processing -->
    <canvas id="photoCanvas"></canvas>
    <canvas id="videoCanvas"></canvas>

    <script>
        // Global Variables
        let currentVideoFile = null;
        let currentPhotoFile = null;
        let currentAudioFile = null;
        let currentVideoElement = null;
        let currentPhotoElement = null;
        let videoFilter = 'none';
        let photoFilter = 'none';
        let videoSpeed = 1.0;
        let textOverlays = [];
        let stickers = [];
        let selectedTextColor = '#FFFFFF';
        let selectedFontSize = 24;
        let selectedFontStyle = 'normal';
        let selectedQuality = '1080p';
        let originalPhotoData = null;
        let videoClips = [];
        let currentRotation = 0;
        let currentFlipH = false;
        let currentFlipV = false;
        let currentAspectRatio = '16:9';
        let currentEffect = 'none';
        let currentFrame = 'none';

        // Photo adjustments
        let photoBrightness = 100;
        let photoContrast = 100;
        let photoSaturation = 100;
        let photoHue = 0;
        let photoBlur = 0;
        let photoRotation = 0;
        let photoFlipH = false;
        let photoFlipV = false;

        // Tab Switching
        function switchTab(tabName) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Load Video
        function loadVideo(event) {
            const file = event.target.files[0];
            if (!file) return;

            currentVideoFile = file;
            const url = URL.createObjectURL(file);

            // Add to clips array
            videoClips.push({ file: file, url: url });

            const videoPreview = document.getElementById('videoPreview');
            videoPreview.innerHTML = `
                <video id="videoPlayer" controls style="max-width: 100%; max-height: 500px; border-radius: 10px;">
                    <source src="${url}" type="${file.type}">
                </video>
            `;

            currentVideoElement = document.getElementById('videoPlayer');
            
            // Show tools and buttons
            document.getElementById('videoTools').style.display = 'block';
            document.getElementById('exportVideoBtn').style.display = 'inline-flex';
            document.getElementById('reverseBtn').style.display = 'inline-flex';
            document.getElementById('videoTimeline').style.display = 'block';

            updateVideoClipsList();
            resetVideoSettings();
        }

        function updateVideoClipsList() {
            const clipsList = document.getElementById('videoClipsList');
            clipsList.innerHTML = '';
            
            videoClips.forEach((clip, index) => {
                const clipDiv = document.createElement('div');
                clipDiv.className = 'timeline-clip';
                clipDiv.innerHTML = `
                    Clip ${index + 1}
                    <button class="clip-remove" onclick="removeClip(${index})">√ó</button>
                `;
                clipsList.appendChild(clipDiv);
            });
        }

        function removeClip(index) {
            videoClips.splice(index, 1);
            if (videoClips.length === 0) {
                resetVideoEditor();
            } else {
                updateVideoClipsList();
            }
        }

        function resetVideoEditor() {
            document.getElementById('videoPreview').innerHTML = `
                <div class="upload-prompt">
                    <div class="icon">üé•</div>
                    <p>Selecciona un video para comenzar</p>
                    <label for="videoInput" class="btn btn-primary">
                        ‚ûï Seleccionar Video
                    </label>
                </div>
            `;
            document.getElementById('videoTools').style.display = 'none';
            document.getElementById('exportVideoBtn').style.display = 'none';
            document.getElementById('reverseBtn').style.display = 'none';
            document.getElementById('videoTimeline').style.display = 'none';
        }

        function resetVideoSettings() {
            videoFilter = 'none';
            videoSpeed = 1.0;
            textOverlays = [];
            stickers = [];
            currentRotation = 0;
            currentFlipH = false;
            currentFlipV = false;
            updateVideoFilters();
        }

        // Load Photo
        function loadPhoto(event) {
            const file = event.target.files[0];
            if (!file) return;

            currentPhotoFile = file;
            const reader = new FileReader();

            reader.onload = function(e) {
                const photoPreview = document.getElementById('photoPreview');
                photoPreview.innerHTML = `
                    <img id="photoImage" src="${e.target.result}" style="max-width: 100%; max-height: 500px; border-radius: 10px;">
                `;

                currentPhotoElement = document.getElementById('photoImage');
                originalPhotoData = e.target.result;

                document.getElementById('photoTools').style.display = 'block';
                document.getElementById('exportPhotoBtn').style.display = 'inline-flex';
                document.getElementById('cropBtn').style.display = 'inline-flex';

                resetPhotoSettings();
            };

            reader.readAsDataURL(file);
        }

        function resetPhotoSettings() {
            photoFilter = 'none';
            photoBrightness = 100;
            photoContrast = 100;
            photoSaturation = 100;
            photoHue = 0;
            photoBlur = 0;
            photoRotation = 0;
            photoFlipH = false;
            photoFlipV = false;
            
            document.getElementById('brightnessSlider').value = 100;
            document.getElementById('contrastSlider').value = 100;
            document.getElementById('saturationSlider').value = 100;
            document.getElementById('hueSlider').value = 0;
            document.getElementById('blurSlider').value = 0;
            
            updatePhotoDisplay();
        }

        // Load Audio
        function loadAudio(event) {
            const file = event.target.files[0];
            if (!file) return;
            currentAudioFile = file;
            alert('‚úÖ M√∫sica agregada: ' + file.name + '\n\nLa m√∫sica se agregar√° al exportar el video.');
        }

        // Apply Video Filter
        function applyVideoFilter(filter) {
            videoFilter = filter;
            updateVideoFilters();
            document.querySelectorAll('#video .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        function updateVideoFilters() {
            if (!currentVideoElement) return;

            const filters = {
                'none': 'none',
                'vintage': 'sepia(0.5) contrast(1.2) brightness(0.9)',
                'bw': 'grayscale(100%)',
                'sepia': 'sepia(100%)',
                'cool': 'hue-rotate(180deg) saturate(1.5)',
                'warm': 'hue-rotate(30deg) saturate(1.3)',
                'vibrant': 'saturate(1.8) contrast(1.3)',
                'dramatic': 'contrast(1.5) brightness(0.9) saturate(0.8)',
                'cinematic': 'contrast(1.2) saturate(0.9) brightness(0.95)',
                'retro': 'sepia(0.3) hue-rotate(-10deg) saturate(1.4)'
            };

            let filterString = filters[videoFilter] || 'none';
            
            if (currentEffect !== 'none') {
                filterString += ' ' + getEffectFilter(currentEffect);
            }

            currentVideoElement.style.filter = filterString.trim();
            applyRotationAndFlip(currentVideoElement, currentRotation, currentFlipH, currentFlipV);
        }

        // Set Video Speed
        function setVideoSpeed(speed) {
            videoSpeed = speed;
            if (currentVideoElement) {
                currentVideoElement.playbackRate = speed;
            }
            document.querySelectorAll('.speed-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        // Apply Photo Filter
        function applyPhotoFilter(filter) {
            photoFilter = filter;
            updatePhotoDisplay();
            document.querySelectorAll('#photo .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        // Adjust Photo
        function adjustPhoto() {
            photoBrightness = document.getElementById('brightnessSlider').value;
            photoContrast = document.getElementById('contrastSlider').value;
            photoSaturation = document.getElementById('saturationSlider').value;
            photoHue = document.getElementById('hueSlider').value;
            photoBlur = document.getElementById('blurSlider').value;

            document.getElementById('brightnessValue').textContent = photoBrightness + '%';
            document.getElementById('contrastValue').textContent = photoContrast + '%';
            document.getElementById('saturationValue').textContent = photoSaturation + '%';
            document.getElementById('hueValue').textContent = photoHue + '¬∞';
            document.getElementById('blurValue').textContent = photoBlur + 'px';

            updatePhotoDisplay();
        }

        function updatePhotoDisplay() {
            if (!currentPhotoElement) return;

            const filters = {
                'none': '',
                'vintage': 'sepia(0.5) contrast(1.2) brightness(0.9)',
                'bw': 'grayscale(100%)',
                'sepia': 'sepia(100%)',
                'cool': 'hue-rotate(180deg) saturate(1.5)',
                'warm': 'hue-rotate(30deg) saturate(1.3)',
                'vibrant': 'saturate(1.8) contrast(1.3)',
                'fade': 'opacity(0.8) brightness(1.1)',
                'nashville': 'sepia(0.2) contrast(1.2) brightness(1.05) saturate(1.2)',
                'lomo': 'contrast(1.5) saturate(1.1)'
            };

            let filterString = '';
            filterString += `brightness(${photoBrightness}%) `;
            filterString += `contrast(${photoContrast}%) `;
            filterString += `saturate(${photoSaturation}%) `;
            filterString += `hue-rotate(${photoHue}deg) `;
            filterString += `blur(${photoBlur}px) `;
            filterString += (filters[photoFilter] || '');

            currentPhotoElement.style.filter = filterString.trim();
            applyRotationAndFlip(currentPhotoElement, photoRotation, photoFlipH, photoFlipV);
            applyFrameStyle();
        }

        // Rotation Functions
        function rotateVideo(degrees) {
            currentRotation = (currentRotation + degrees) % 360;
            updateVideoFilters();
        }

        function rotatePhoto(degrees) {
            photoRotation = (photoRotation + degrees) % 360;
            updatePhotoDisplay();
        }

        function flipVideo(direction) {
            if (direction === 'horizontal') {
                currentFlipH = !currentFlipH;
            } else {
                currentFlipV = !currentFlipV;
            }
            updateVideoFilters();
        }

        function flipPhoto(direction) {
            if (direction === 'horizontal') {
                photoFlipH = !photoFlipH;
            } else {
                photoFlipV = !photoFlipV;
            }
            updatePhotoDisplay();
        }

        function applyRotationAndFlip(element, rotation, flipH, flipV) {
            let transform = `rotate(${rotation}deg)`;
            if (flipH) transform += ' scaleX(-1)';
            if (flipV) transform += ' scaleY(-1)';
            element.style.transform = transform;
        }

        // Effects
        function applyEffect(effect) {
            currentEffect = effect;
            updateVideoFilters();
            document.querySelectorAll('.effect-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.closest('.effect-btn').classList.add('active');
        }

        function getEffectFilter(effect) {
            const effects = {
                'blur': 'blur(5px)',
                'sharpen': 'contrast(1.5)',
                'vignette': 'brightness(0.8)',
                'glow': 'brightness(1.2) contrast(0.9)',
                'pixelate': 'contrast(2)',
                'invert': 'invert(100%)'
            };
            return effects[effect] || '';
        }

        // Aspect Ratio
        function setAspectRatio(ratio) {
            currentAspectRatio = ratio;
            document.querySelectorAll('.aspect-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            alert(`üìê Formato de aspecto cambiado a ${ratio}\n\nEsto se aplicar√° al exportar.`);
        }

        // Audio Controls
        function adjustVolume() {
            const volume = document.getElementById('volumeSlider').value;
            document.getElementById('volumeValue').textContent = volume + '%';
            if (currentVideoElement) {
                currentVideoElement.volume = volume / 100;
            }
        }

        function muteVideo() {
            if (currentVideoElement) {
                currentVideoElement.muted = !currentVideoElement.muted;
                event.target.textContent = currentVideoElement.muted ? 'üîä Activar Audio' : 'üîá Silenciar Original';
            }
        }

        // Text Overlay Functions
        function openTextModal() {
            document.getElementById('textModal').classList.add('active');
            document.getElementById('textInput').value = '';
            document.getElementById('fontSizeSlider').value = 24;
            document.getElementById('fontSizeValue').textContent = '24px';
        }

        function closeTextModal() {
            document.getElementById('textModal').classList.remove('active');
        }

        function selectFontStyle(style) {
            selectedFontStyle = style;
            document.querySelectorAll('[data-style]').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        document.getElementById('fontSizeSlider').addEventListener('input', function() {
            selectedFontSize = this.value;
            document.getElementById('fontSizeValue').textContent = this.value + 'px';
        });

        document.querySelectorAll('.color-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.color-option').forEach(opt => {
                    opt.classList.remove('active');
                });
                this.classList.add('active');
                selectedTextColor = this.dataset.color;
            });
        });

        function addTextOverlay() {
            const text = document.getElementById('textInput').value.trim();
            if (!text) {
                alert('Por favor escribe un texto');
                return;
            }

            const overlay = {
                id: Date.now(),
                text: text,
                color: selectedTextColor,
                fontSize: selectedFontSize,
                fontStyle: selectedFontStyle
            };

            textOverlays.push(overlay);
            updateTextOverlaysList();
            closeTextModal();
        }

        function updateTextOverlaysList() {
            const list = document.getElementById('textOverlaysList');
            if (textOverlays.length === 0) {
                list.innerHTML = '';
                return;
            }

            list.innerHTML = '<div style="margin-top: 15px;">';
            textOverlays.forEach(overlay => {
                list.innerHTML += `
                    <div style="display: flex; align-items: center; justify-content: space-between; padding: 10px; background: white; border-radius: 8px; margin-bottom: 8px;">
                        <span style="color: ${overlay.color}; font-size: ${overlay.fontSize}px; font-weight: ${overlay.fontStyle === 'bold' ? 'bold' : 'normal'}; font-style: ${overlay.fontStyle === 'italic' ? 'italic' : 'normal'};">${overlay.text}</span>
                        <button onclick="removeTextOverlay(${overlay.id})" style="background: none; border: none; cursor: pointer; font-size: 1.2em; color: #999;">‚úï</button>
                    </div>
                `;
            });
            list.innerHTML += '</div>';
        }

        function removeTextOverlay(id) {
            textOverlays = textOverlays.filter(overlay => overlay.id !== id);
            updateTextOverlaysList();
        }

        // Stickers
        function addSticker(emoji) {
            stickers.push({ id: Date.now(), emoji: emoji });
            alert(`‚úÖ Sticker ${emoji} agregado!\n\nSe mostrar√° al exportar.`);
        }

        function addPhotoSticker(emoji) {
            alert(`‚úÖ Sticker ${emoji} agregado a la foto!\n\nSe aplicar√° al guardar.`);
        }

        // Frames
        function applyFrame(frame) {
            currentFrame = frame;
            applyFrameStyle();
            document.querySelectorAll('#photo .effect-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        function applyFrameStyle() {
            if (!currentPhotoElement) return;
            
            const frames = {
                'none': 'none',
                'classic': '10px solid #8B4513',
                'polaroid': '15px solid white',
                'modern': '5px solid #333'
            };

            currentPhotoElement.style.border = frames[currentFrame] || 'none';
            if (currentFrame === 'polaroid') {
                currentPhotoElement.style.boxShadow = '0 4px 8px rgba(0,0,0,0.3)';
            } else {
                currentPhotoElement.style.boxShadow = 'none';
            }
        }

        // Crop Photo
        function cropPhoto() {
            alert('üîß Funci√≥n de recorte en desarrollo.\n\nPuedes usar las herramientas de rotaci√≥n y formato de aspecto mientras tanto.');
        }

        // Reverse Video
        function reverseVideo() {
            alert('‚è™ Funci√≥n de video en reversa en desarrollo.\n\nRequiere procesamiento de video avanzado.');
        }

        // Collage
        function loadCollageImages(event) {
            const files = Array.from(event.target.files);
            if (files.length < 2) {
                alert('Por favor selecciona al menos 2 fotos para el collage');
                return;
            }
            alert(`‚úÖ ${files.length} fotos seleccionadas!\n\nFunci√≥n de collage en desarrollo.`);
        }

        // GIF Maker
        function loadGifVideo(event) {
            const file = event.target.files[0];
            if (!file) return;
            alert('üéûÔ∏è Video cargado para GIF!\n\nFunci√≥n de conversi√≥n a GIF en desarrollo.');
        }

        // Export Functions
        function exportVideo() {
            document.getElementById('exportModal').classList.add('active');
        }

        function exportPhoto() {
            document.getElementById('exportModal').classList.add('active');
        }

        function closeExportModal() {
            document.getElementById('exportModal').classList.remove('active');
        }

        function selectQuality(quality) {
            selectedQuality = quality;
            document.querySelectorAll('.quality-option').forEach(option => {
                option.classList.remove('active');
            });
            event.target.closest('.quality-option').classList.add('active');
        }

        async function processExport() {
            closeExportModal();
            showLoading('Procesando y exportando...');

            await new Promise(resolve => setTimeout(resolve, 2000));

            if (currentVideoElement) {
                await exportVideoFile();
            } else if (currentPhotoElement) {
                await exportPhotoFile();
            }

            hideLoading();
        }

        async function exportVideoFile() {
            try {
                const link = document.createElement('a');
                link.href = URL.createObjectURL(currentVideoFile);
                link.download = `video-editado-${Date.now()}.${currentVideoFile.name.split('.').pop()}`;
                link.click();

                let message = '‚úÖ Video exportado exitosamente!\n\n';
                message += 'üìä Configuraci√≥n aplicada:\n';
                message += `- Filtro: ${videoFilter}\n`;
                message += `- Velocidad: ${videoSpeed}x\n`;
                message += `- Calidad: ${selectedQuality}\n`;
                message += `- Textos: ${textOverlays.length}\n`;
                message += `- Stickers: ${stickers.length}\n`;
                if (currentAudioFile) message += `- M√∫sica: ${currentAudioFile.name}\n`;
                message += '\n‚ö†Ô∏è Nota: En esta versi√≥n web, los efectos se aplican visualmente. Para procesamiento completo con FFmpeg, usa la versi√≥n de escritorio.';
                
                alert(message);
            } catch (error) {
                alert('Error al exportar el video: ' + error.message);
            }
        }

        async function exportPhotoFile() {
            try {
                const canvas = document.getElementById('photoCanvas');
                const ctx = canvas.getContext('2d');
                const img = currentPhotoElement;

                const qualitySettings = {
                    '720p': { width: 1280, height: 720 },
                    '1080p': { width: 1920, height: 1080 },
                    '4k': { width: 3840, height: 2160 }
                };

                const settings = qualitySettings[selectedQuality];
                const aspectRatio = img.naturalWidth / img.naturalHeight;

                if (aspectRatio > settings.width / settings.height) {
                    canvas.width = settings.width;
                    canvas.height = settings.width / aspectRatio;
                } else {
                    canvas.height = settings.height;
                    canvas.width = settings.height * aspectRatio;
                }

                // Apply all filters to canvas
                ctx.filter = currentPhotoElement.style.filter;
                ctx.save();
                
                // Apply rotation
                ctx.translate(canvas.width / 2, canvas.height / 2);
                ctx.rotate(photoRotation * Math.PI / 180);
                if (photoFlipH) ctx.scale(-1, 1);
                if (photoFlipV) ctx.scale(1, -1);
                ctx.translate(-canvas.width / 2, -canvas.height / 2);
                
                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                ctx.restore();

                canvas.toBlob(blob => {
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(blob);
                    link.download = `foto-editada-${Date.now()}.jpg`;
                    link.click();

                    let message = '‚úÖ Foto guardada exitosamente!\n\n';
                    message += 'üìä Configuraci√≥n aplicada:\n';
                    message += `- Filtro: ${photoFilter}\n`;
                    message += `- Brillo: ${photoBrightness}%\n`;
                    message += `- Contraste: ${photoContrast}%\n`;
                    message += `- Saturaci√≥n: ${photoSaturation}%\n`;
                    message += `- Rotaci√≥n: ${photoRotation}¬∞\n`;
                    message += `- Calidad: ${selectedQuality}\n`;
                    
                    alert(message);
                }, 'image/jpeg', 0.95);

            } catch (error) {
                alert('Error al guardar la foto: ' + error.message);
            }
        }

        function showLoading(text) {
            document.getElementById('loadingText').textContent = text;
            document.getElementById('loadingOverlay').classList.add('active');
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').classList.remove('active');
        }

        // Initialize
        console.log('üé¨ Video & Photo Editor PRO cargado correctamente');
        console.log('‚ú® M√°s de 50 funciones disponibles');
        console.log('üöÄ Versi√≥n mejorada con nuevas caracter√≠sticas');
    </script>
</body>
</html>
